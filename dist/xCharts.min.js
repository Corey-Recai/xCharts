/**
 * xg-xcharts - charts base on d3.js
 * @version v0.1.5
*/
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.xCharts=e()}(this,function(){return function(t){function e(t){return l?new e.prototype.init(t):void console.error("The library depends on d3js http://d3js.org/ ")}function i(t,e,i){var n=getComputedStyle(t),r=n[e];return i?parseFloat(r):r}function n(t){var e=i(t,"width",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderLeftWidth",!0)-i(t,"paddingLeft",!0)-i(t,"paddingRight",!0)-i(t,"borderRightWidth",!0)}function r(t){var e=i(t,"height",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderTopWidth",!0)-i(t,"paddingTop",!0)-i(t,"paddingBottom",!0)-i(t,"borderBottomWidth",!0)}function a(t,e){var i={};e.getColor;t.forEach(function(t){var e=t.type;i[e]=void 0==i[e]?i[e]=[]:i[e],i[e].push(t)});for(var n in i)if(i.hasOwnProperty(n))switch(n){case"line":case"scatter":case"bar":i[n].forEach(function(t,e){t.idx=e});break;case"pie":case"funnel":case"radar":i[n].forEach(function(t){t.data.forEach(function(t,e){t.idx=e})});break;default:console.error("type=%d not supported")}}function o(t){var i=e.utils;this.config=i.copy(t,!0),this.getColor=i.getColor(t.color),this.config.animation&&this.config.animation.enable?this.config.animation=i.merage(i.copy(f),this.config.animation):(this.config.animation=i.copy(f),this.config.animation.animationTime=0)}function s(t){var e=t.attr("xcharts-id"),i=u[e];i.fire("chartRemoveBind"),delete u[e]}function c(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<e.length;n++)if(t.indexOf(e[n])>0){i=!1;break}return!i}var l=t.d3,h=1,d=c();e.extend=e.prototype.extend=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])};var u={};e.prototype.extend({init:function(t){t=l.select(t);var i=t.select(".xc-container");i.node()&&s(i),t.html(""),this.mobileMode=d,this.container=t,this.originalWidth=n(t.node()),this.originalHeight=r(t.node()),this.id=h++,this.div=t.append("div").attr("class","xc-container"),this.svg=this.div.append("svg").attr("class","xc-svg").attr("width",this.originalWidth).attr("height",this.originalHeight),this.defs=this.svg.append("defs"),this.clippath=this.defs.append("clipPath").attr("id","xc-firstdraw-"+this.id),this.firstDrawingRect=this.clippath.append("rect").attr("x",0).attr("y",0).attr("width",0).attr("height",this.originalHeight),this.svg.attr("clip-path","url(#xc-firstdraw-"+this.id+")"),this.main=this.svg.append("g").attr("class","xc-main"),this.margin={top:15,left:10,right:15,bottom:30},this.originMargin=e.utils.copy(this.margin),this.EventList={};var a=Math.random().toString(36).substr(2);return this.div.attr("xcharts-id",a),u[a]=this,this},loadConfig:function(t){o.call(this,t),this.firstDrawing(this.config)},firstDrawing:function(t){var i,n=["title","tooltip","legend","yAxis","xAxis","resize"],r=0;for(this.components={},this.charts={};i=n[r++];)if(t[i]&&!this.components[i]){var o=e.components[i];"xAxis"!=i&&"yAxis"!=i||(o=e.components.axis),o?this.components[i]=new o(this,t,i):console.warn("components/%s.js is not loaded!",i.match(/Axis/)?"axis":i)}a(t.series,this),this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.main.attr("transform","translate("+this.margin.left+","+this.margin.top+")"),t.series||(t.series=[]);for(var s,r=0;s=t.series[r++];){var c=s.type;if(!this.charts[c]){var l=e.charts[c];l?this.charts[c]=new l(this,t):console.warn("charts/%s.js is not loaded!",c)}}var h;h=this.config.animation.enable?"width "+this.config.animation.animationTime+"ms linear":"width 0ms linear",this.firstDrawingRect.style("transition",h),this.firstDrawingRect.style("width",this.originalWidth);var d=this;setTimeout(function(){d.svg.attr("clip-path","")},this.config.animation.animationTime+100)},refresh:function(){if(this.originalWidth=n(this.container.node()),this.originalHeight=r(this.container.node()),isNaN(this.originalWidth)||isNaN(this.originalHeight))throw"container not found";this.margin=e.utils.copy(this.originMargin),this.svg.attr("width",this.originalWidth).attr("height",this.originalHeight);var t=this.refreshAnimationTime,i=this.refreshAnimationEase,a=this.components,o=this.charts;for(var s in a)if(a.hasOwnProperty(s)){var c=a[s];c.refresh(i,t)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];l.refresh(i,t)}},_updateSeries:function(t){this.config.series=e.utils.copy(t,!0),this.margin=e.utils.copy(this.originMargin);var i=this.components,n=this.charts;for(var r in i)if(i.hasOwnProperty(r)){var a=i[r];a.updateSeries(this.config.series)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];o.updateSeries(this.config.series)}},on:function(t,e){var i=this.EventList,n=t.split("."),r=n[0],a=n[1]?n[1]:"default";i[r]||(i[r]=[]);for(var o,s=0;o=i[r][s++];)if(o.nameSpace==a){i[r].splice(s-1,1);break}i[r].push({nameSpace:a,callback:e})},fire:function(t){var e=Array.prototype.slice.call(arguments,1),i=this.EventList[t];i&&i.forEach(function(t){t.callback.apply("",e)})}}),e.prototype.init.prototype=e.prototype,e.extend({charts:{extend:e.extend},components:{extend:e.extend},utils:{extend:e.extend}});var f={enable:!1,animationTime:500,animationEase:"linear"};t.xCharts=e}(window),function(){function t(t,e){if(!t)return t;var i=c.getType(t);if("Object"==i||"Array"==i){var n,r="Object"==i?{}:[];for(var a in t)t.hasOwnProperty(a)&&(n=t[a],e&&(c.isObject(n)||c.isArray(n))?r[a]=arguments.callee(n,!0):r[a]=t[a]);return r}return t}function e(t,e){var i;for(var n in e)if(e.hasOwnProperty(n)){if(i=e[n],c.isObject(i))t[n]=t[n]||{};else{if(!c.isArray(i)){t[n]=e[n];continue}t[n]=t[n]||[]}arguments.callee(t[n],e[n],!0)}return t}function i(t,e){function i(){this.superClass=e.prototype}t.prototype;i.prototype=e.prototype,t.prototype=new i,t.constructor=t}function n(t){return t}function r(t){return t||Array.isArray(t)||(t=["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]),function(e){return t[e%t.length]}}function a(t,e,i,n){Array.isArray(t)||(t=[t]),void 0===i&&(i=0),void 0===n&&(n=0);var r=document.createElement("span");r.style.fontSize=e+"px",r.style.margin="0px",r.style.padding="0px",r.style.border="none",r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r);var a=[],o=[];return t.forEach(function(t){void 0===r.innerText?r.textContent=t:r.innerText=t;var e=parseFloat(r.offsetWidth)+i,s=parseFloat(r.offsetHeight)+n;a.push(e),o.push(s)}),document.body.removeChild(r),{widthList:a,heightList:o}}function o(t,e,i,n){var r,a,o,s=+new Date,c=0,l=0,h=null,d=function(){l=s,t.apply(a,o)};return function(){s=+new Date,a=this,o=arguments,r=s-(n?c:l)-e,clearTimeout(h),n?i?h=setTimeout(d,e):r>=0&&d():r>=0?d():i&&(h=setTimeout(d,-r)),c=s}}function s(t,e,i){return o(t,e,i,!0)}var c=xCharts.utils,l=Object.prototype.toString,h=["Arguments","Object","Array","Function","String","Number","Date","RegExp","Error"];h.forEach(function(t){c["is"+t]=function(e){return l.call(e)==="[object "+t+"]"}}),c.getType=function(t){var e=l.call(t),i=e.match(/\[object\s(\w+?)\]/)[1];return i},c.copy=t,c.merage=e,c.inherits=i,c.loop=n,c.getColor=r,c.calcTextWidth=a,c.throttle=o,c.debounce=s}(),function(){function t(t,e,i){this.messageCenter=t,this.config=e,this.type=i,this.main=t.main,this.margin=t.margin,this.svg=t.svg,this.div=t.div,this.init(t,e,i,this.config.series),this.render("linear",0),this.ready()}t.prototype={constructor:t,init:function(t,e,i){},render:function(t,e){},ready:function(){},refresh:function(t,e){return this._show?(this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.init(this.messageCenter,this.config,this.type,this.config.series),void this.render(t,e)):!0},updateSeries:function(t){return this._show?(this.init(this.messageCenter,this.config,this.type,t),this.render("linear",0),void this.ready()):!0},on:function(){this.messageCenter.on.apply(this.messageCenter,arguments)},fire:function(){this.messageCenter.fire.apply(this.messageCenter,arguments)}},xCharts.components.extend({Component:t})}(),function(t){function e(t,e,i){this._show=!0,x.Component.call(this,t,e,i)}function i(t,e){t.forEach(function(t){"value"===t.scaleType||"time"===t.scaleType?t.range(e):"barCategory"===t.scaleType?t.rangeRoundBands(e,0,.1):"category"===t.scaleType&&t.rangeRoundPoints(e)})}function n(t,e,i,n){if(e){var r=n.domain().map(function(t){return i.tickFormat(t)}),a=p.calcTextWidth(r,14).widthList,o=a[a.length-1],s=t.margin.right;o/2>s&&(t.margin.right+=Math.round(o/2)-s);var c=a[0],l=t.margin.left;c/2>l&&(t.margin.left+=Math.round(c/2)-l)}else{var r=n.ticks().map(function(t){return i.tickFormat(t)}),a=p.calcTextWidth(r,14).widthList,h=g.max(a);h=void 0==h?0:h,"right"===i.position?t.margin.right+=h:t.margin.left+=h}}function r(t,e,i){var n=v[t.type];return n?n.call(i,t,e):void console.error('axis[%d].type = "%s" is not supported',e,t.type)}function a(t,e){if(!t.data)return void console.error("axis[%d].data is not defined!",e);if(h(this.config.series)){var i=g.scale.ordinal().domain(t.data);i.scaleType="barCategory"}else{var i=g.scale.ordinal().domain(t.data);i.scaleType="category"}return i}function o(t,e){var i=this.series,n=this.type;i.map(function(t){null==t[n+"Index"]&&(t[n+"Index"]=0)});var r=[],a=[];for(var o in m)if(m.hasOwnProperty(o)){var s=m[o](i,n,e);s&&r.push(s)}a[0]=g.min(r,function(t){return t[0]}),a[1]=g.max(r,function(t){return t[1]}),a[0]===a[1]&&null!=a[0]&&null!=a[1]&&(a[0]>0?a[0]=0:a[1]=0),a[0]>t.minValue&&(a[0]=t.minValue),a[1]<t.maxValue&&(a[1]=t.maxValue);var c=g.scale.linear().domain(a);if(c.scaleType="value",t.ticks<2||this.legendRefresh){var l=c.ticks().length,h=Math.ceil(l/2);h>=2&&(t.ticks=h)}var h=c.ticks(t.ticks),d=h[1]-h[0];return a[0]%d===0||isNaN(d)||(a[0]=parseInt(a[0]/d)*d),a[1]%d===0||isNaN(d)||(a[1]=(parseInt(a[1]/d)+1)*d),c.domain(a),c}function s(t,e){var i=g.time.scale().domain(g.extent(t.data,function(t){return+new Date(t)}));if(this.isXAxis){for(var n,r=this.config.series,a=1,o=0;n=r[o++];){var s=void 0==n.xAxisIndex?0:n.xAxisIndex;if("line"==n.type&&s==e){a=n.data.length-1;break}}var c=i.domain(),l=c[1]-c[0],h=l/a;t.data=[+c[0]];for(var o=0;a>o;o++)t.data[o+1]=+c[0]+Math.round(h*(o+1),1)}return i.scaleType="time",i}function c(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n];if("category"===r.scaleType||"barCategory"===r.scaleType){for(var a=p.copy(r.domain()),o=r.range(),s=e[n],c=a.map(function(t){return s.tickFormat(t)}),l=p.calcTextWidth(c,14).widthList,h=parseInt((o[o.length-1]-o[0])/(a.length-1)),d=0,u=1,f=1;f<l.length;f++){var g=l[d],x=l[u];(g+x)/2>h*(f-d)?a[f]=null:(u=f+1,d=f)}a=a.filter(function(t){return null!==t}),i.push(a)}}return i}function l(t){var e=t.position,i=[0,0];return"right"==e?i=[this.width,0]:"bottom"==e&&(i=[0,this.height]),"translate("+i+")"}function h(t){for(var e,i=0;e=t[i++];)if("bar"===e.type)return!0;return!1}function d(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n],a=e[n].data,o={};r.forEach(function(t){for(var e=0;e<a.length&&t!==a[e];e++);e==a.length&&console.error("data和value不匹配"),o[e]=!0}),i[n]=o}return i}function u(t){var e={tickFormat:p.loop,ticks:-1,formatter:function(t){return"<p>"+this.tickFormat(t)+"</p>"},position:"xAxis"==t?"bottom":"left",show:!0};return e}var f=t.xCharts,p=f.utils,g=t.d3,x=f.components;p.inherits(e,x.Component),x.extend({axis:e}),e.prototype.extend=f.extend,e.prototype.extend({init:function(t,e,a,o){this.isXAxis="xAxis"===a,this.axisConfig=e[a],this.series=o;for(var s=[],l=0;l<this.axisConfig.length;l++){var e=p.merage(u(a),this.axisConfig[l]),h=r(e,l,this),f=h.domain();isNaN(f[0])&&isNaN(f[1])&&"value"===h.scaleType&&(h=this.scales[l]),this.legendRefresh||n(this,this.isXAxis,e,h),this.axisConfig[l]=e,s[l]=h,this.axisConfig[l]=e}this.width=t.originalWidth-t.margin.left-t.margin.right,this.height=t.originalHeight-t.margin.top-t.margin.bottom,this.range=this.isXAxis?[0,this.width]:[this.height,0],i(s,this.range),this.isXAxis&&(this.showDomainList=c(s,this.axisConfig),t.showDomainList=d(this.showDomainList,this.axisConfig)),this.messageCenter[this.type+"Scale"]=s,this.scales=s},render:function(t,e){return this.isXAxis?this.__drawAxis(t,e):void this.on("xAxisReady.yAxis",function(){this.width=this.messageCenter.originalWidth-this.margin.left-this.margin.right,this.__drawAxis(t,e)}.bind(this))},__drawAxis:function(t,e){for(var i,n=this.type,r=this.scales,a=0;(i=this.axisConfig[a])&&i.show;a++){var o=r[a],s=g.svg.axis().scale(o).outerTickSize(0).ticks(i.ticks).orient(i.position).tickFormat(i.tickFormat);this.isXAxis||0!==a?0===a?(s.innerTickSize(-this.height),s.tickPadding(10),s.tickValues(this.showDomainList[a])):s.innerTickSize(0):s.innerTickSize(-this.width);var c=this.main.selectAll(".xc-axis."+n+"-"+a).data([i]);c.enter().append("g").attr("class","xc-axis "+n+" "+n+"-"+a).attr("fill","none").attr("stroke","#000"),"barCategory"===o.scaleType&&c.classed("xc-bar-axis",!0),c.attr("transform",l.call(this,i)).transition().ease(t).duration(e).call(s)}this.isXAxis&&this.fire("xAxisReady")},ready:function(){this._tooltipReady(),this._lengendReady()},_tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"===this.config.tooltip.trigger&&"yAxis"!=this.type){var t=this.axisConfig[0];this.on("tooltipSectionChange.axis",function(e,i){var n=t.data[e],r=t.formatter(n);i(r)})}},_lengendReady:function(){var t=this;this.on("legendClick."+t.type,function(e){var i=t.series;i.forEach(function(t){var i=t.name;t.show=!1;for(var n,r=0;n=e[r++];)if(n==i){t.show=!0;break}}),t.legendRefresh=!0,t.init(t.messageCenter,t.config,t.type,i),t.render(t.config.animation.animationEase,t.config.animation.animationTime),t.legendRefresh=!1})}});var v={value:o,time:s,category:a},m={line:function(t,e,i){var n={},r=[];g.map(t,function(t){return"line"!=t.type||t[e+"Index"]!=i||0==t.show?!1:(t.stack&&(n[t.stack]||(n[t.stack]=[]),n[t.stack].push(t.data)),void(r=r.concat(t.data)))});for(var a in n)if(n.hasOwnProperty(a)){var o=[];n[a].forEach(function(t,e){t.forEach(function(t,e){o[e]=null==o[e]?0:o[e],o[e]+=t})}),r=r.concat(o)}return 0==r.length?!1:g.extent(r,function(t){return parseFloat(t)})},bar:function(t,e,i){var n={},r=[];g.map(t,function(t){return"bar"!=t.type||t[e+"Index"]!=i||0==t.show?!1:(t.stack&&(n[t.stack]||(n[t.stack]=[]),n[t.stack].push(t.data)),void(r=r.concat(t.data)))});for(var a in n)if(n.hasOwnProperty(a)){var o=[];n[a].forEach(function(t,e){t.forEach(function(t,e){o[e]=null==o[e]?0:o[e],o[e]+=t})}),r=r.concat(o)}return 0==r.length?!1:g.extent(r,function(t){return parseFloat(t)})},scatter:function(t,e,i){var n=[];return g.map(t,function(t){"scatter"==t.type&&t[e+"Index"]==i&&0!=t.show&&g.map(t.data,function(t){n.push(t["xAxis"==e?0:1])})}),0==n.length?!1:g.extent(n,function(t){return parseFloat(t)})}}}(window),function(t){function e(t,e,i){return e.legend.show===!1?void(this._show=!1):(this._show=!0,void y.call(this,t,e,i))}function i(t,e,i){if(e){for(var n,r=!0,a=0;n=i[a++];)if(n==t){i.splice(a-1,1),r=!1;break}r&&i.push(t),0==i.length?this.fire("tooltipNone"):this.fire("tooltipShow")}else i=[t];this.fire("legendClick",i)}function n(){var t=this,e=t.legendConfig,i=t.legendSeries,n=e.itemGap,r=t.width,a=t.height,o=t.legendConfig.item.fontSize,s=t.legendConfig.item.chartSize,c=o>s?o:s,l=e.x,h=e.y,d=e.orient,u=t.margin,f=t.originalWidth,p=1.1*e.item.chartSize,g=i.map(function(t){return t.name}),m=x.calcTextWidth(g,e.item.chartSize,p).widthList,y=0,C=0,w=0,b=0,_=0;i.forEach(function(t,e){var i=m[e];t.position=[y,C],"vertical"!=d?(y+=i+n,y>r&&(w=r,y=0,C+=1.1*c)):(_=v.max([_,i]),C+=c+n,C>a&&(b=a,C=0,y+=1.1*_))});var S,A,k=30;return w=w?w:y,b=b?b:C,"vertical"!=d?(b+=c,S="right"==l?f-u.right-w:"center"==l?(r-w)/2+u.left:u.left,"top"==h?(A=u.top,u.top+=C+k):(A=a-C+u.top,u.bottom+=C+k)):(w+=_,"right"==l?(S=f-u.right-w,u.right+=w+k):(S=0,u.left+=w+k),A="center"==h?(a-b)/2+u.top:"bottom"==h?a-b+u.top:u.top),[S,A]}function r(t,e,i){var n={},r=[];t.forEach(function(t){var e=t.type;e&&(n[e]||(n[e]=[]),n[e].push(t))});for(var o in n)if(n.hasOwnProperty(o)){var s=a(o);s&&(r=r.concat(s(n[o],e,i)))}return r}function a(t){switch(t){case"radar":case"funnel":case"pie":return o;default:return s}}function o(t,e,i){var n=[];return t.forEach(function(t){var r={},a=0,o=t.type;t.data.forEach(function(t){var s,l=t.name;void 0==r[l]?(r[l]=a,s=a):s=r[l],t.idx=s,c(l,e)&&(t.color=i.getColor(s),t.type=o,n.push(t)),a++})}),n}function s(t,e,i){var n=[],r=i.getColor;return t.forEach(function(t,i){void 0===t.idx&&(t.idx=i),c(t.name,e)&&(t.lineStyle&&"auto"!==t.lineStyle.color?t.color=t.lineStyle.color:t.color=r(i),n.push(t))}),n}function c(t,e,i){for(var n,r=0;n=e[r++];){if(i&&n[i]===t)return n;if(n===t)return n}return!1}function l(t,e){var i=t/6,n=e/2,r="M0,"+n+"L"+2*i+","+n;return r+="A"+i+","+i+" 0 1 1 "+2*i+","+(n+1e-5),r+="M"+4*i+","+n+"L"+6*i+","+n}function h(t){var e=t,i="M0,"+.5*e+" A"+e/2+","+e/2+" 0 1 1 0,"+(.5*e+.001);return i}function d(t){var e=t/2,i=Math.PI/180*30,n=0,r=-e,a=Math.cos(i)*e,o=Math.sin(i)*-e,s=[],c="";return s[0]=[n,r],s[1]=[a,o],s[2]=[a,-o],s[3]=[n,-r],s[4]=[-a,-o],s[5]=[-a,o],s.forEach(function(t){t[0]+=e,t[1]+=e,c+=c?"L":"M",c+=t}),c+="z"}function u(t){var e=t/10;return"M0,"+e+" L"+t+","+e+" L"+.5*t+","+t}function f(t){var e=[0,t/4],i=[t,t/4],n=[t,t/4*3],r=[0,t/4*3];return"M"+e+" L"+i+"L"+n+"L"+r+"z"}function p(){var t={show:!1,orient:"horizontal",x:"left",y:"bottom",itemGap:10,formatter:function(t){return t},selectedMode:"multiple",data:[],item:{fontSize:14,color:"#000",chartSize:20,opacity:.3,hoverColor:"auto"}};return t}var g=t.xCharts,x=g.utils,v=t.d3,m=g.components,y=m.Component;x.inherits(e,y),m.extend({legend:e}),e.prototype.extend=g.extend,e.prototype.extend({init:function(t,e){this.legendConfig=x.merage(p(),e.legend),this.legendSeries=r(e.series,this.legendConfig.data,t),this.originalHeight=t.originalHeight,this.originalWidth=t.originalWidth,this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.groupPosition=n.call(this)},render:function(){var t=this,e=t.legendConfig.item.fontSize,i=t.legendConfig.item.chartSize,n=e>i?e:i,r=t.legendConfig.item.color,a=t.groupPosition,o=t.svg.selectAll(".xc-legend-group").data([t]);o.enter().append("g").attr("class","xc-legend-group"),o.attr("transform","translate("+a+")");var s=o.selectAll(".xc-legend-item").data(t.legendSeries);s.enter().append("g").attr("class","xc-legend-item"),s.exit().remove(),s.attr("transform",function(t){return this.isChecked=void 0==this.isChecked?!0:this.isChecked,"translate("+t.position+")"}).attr("fill",r).attr("opacity",function(){return this.isChecked?1:t.legendConfig.item.opacity}),s.html(""),s.append("text").attr("x",1.1*i).attr("y",function(){return.9*e}).attr("font-size",e).append("tspan").attr("dy",function(){return e>i?0:.5*(i-e)}).text(function(t){return t.name});var c={};s.append("path").attr("d",function(t){if(!C[t.type])throw new Error("pathD."+t.type+" not found");return c[t.type]||(c[t.type]=C[t.type](i,n)),c[t.type]}).attr("stroke",function(t){return t.color}).attr("fill",function(t){return t.color}),t.itemList=s},ready:function(){var t=this,e=t.legendConfig,n=e.item.hoverColor,r=e.item.color,a="single"!=e.selectedMode,o=e.item.opacity,s=a?this.legendSeries.map(function(t){return t.name}):[];t.itemList.on("click.legend",function(e){this.isChecked=!this.isChecked,a?v.select(this).attr("opacity",this.isChecked?1:o):(t.itemList.attr("opacity",o),v.select(this).attr("opacity",1)),i.call(t,e.name,a,s)}),t.itemList.on("mouseenter.legend",function(e){var i;i="auto"==n?e.color:n;var r=v.select(this);r.attr("fill",i),t.fire("legendMouseenter",e.name)}),t.itemList.on("mouseleave.legend",function(e){var i=v.select(this);i.attr("fill",r),t.fire("legendMouseleave",e.name)})}});var C={line:l,radar:d,pie:h,scatter:h,funnel:u,bar:f}}(window),function(t){function e(t,e,i){e.resize.enable&&s.Component.call(this,t,e,i)}function i(t){c[t.messageCenter.id]=t}function n(t){delete c[t.messageCenter.id]}var r=t.xCharts,a=r.utils,o=t.d3,s=r.components;a.inherits(e,s.Component),s.extend({resize:e});var c={};o.select(t).on("resize.refresh",function(){for(var t in c)if(c.hasOwnProperty(t))try{c[t].resize()}catch(e){"string"==typeof e?delete c[t]:console.error(e.stack)}}),e.prototype.extend=r.extend,e.prototype.extend({init:function(t,e,i,n){this.config=a.merage(l,e[i]),t.refreshAnimationEase=this.config.animationEase,t.refreshAnimationTime=this.config.animationTime},ready:function(){var t=this,e=t.config.animationTime,n=a.throttle(function(){t.messageCenter.refresh()},e+300,!0);t.resize=n,i(t),t.on("chartRemoveBind",function(){t.unBind()})},unBind:function(){n(this)},refresh:function(){},updateSeries:function(){}});var l={enable:!1,animationEase:"linear",animationTime:300}}(window),function(t){function e(t,e,i){return e.title.show===!1?void(this._show=!1):(this._show=!0,void s.call(this,t,e,i))}function i(){var t=this,e="start",i=t.titleConfig.textStyle.fontSize,n=t.titleConfig.subtextStyle.fontSize,r=t.titleConfig.x,a=t.titleConfig.y,o=t.height;return"left"===r?(r=0,e="start"):"center"===r?(r="50%",e="middle"):"right"===r&&(r="100%",e="end"),"top"==a?(a="1em",t.margin.top+=parseFloat(i)+parseFloat(n)):"center"==a?a="50%":"bottom"==a&&(a=o-parseFloat(n)-parseFloat(i)),{x:r,y:a,textAnchor:e}}function n(){var t={show:!0,text:"",subtext:"",x:"center",y:"top",textStyle:{fontSize:14,color:"#000"},subtextStyle:{fontSize:12,color:"#00"}};return t}var r=t.xCharts,a=r.utils,o=(t.d3,r.components),s=o.Component;a.inherits(e,s),o.extend({title:e}),e.prototype.extend=r.extend,e.prototype.extend({init:function(t){this.titleConfig=a.merage(n(),this.config.title),this.height=t.originalHeight,this.titlePosition=i.call(this)},render:function(){var t=this,e=t.titleConfig.textStyle.fontSize,i=t.titleConfig.subtextStyle.fontSize,n=t.titlePosition.x,r=t.titlePosition.y,a=t.titlePosition.textAnchor,o=t.svg.selectAll(".xc-title").data([t.titleConfig]);o.enter().append("text").attr("class","xc-title");var s=o.selectAll(".xc-title-text").data([t.titleConfig]);s.enter().append("tspan").attr("class","xc-title-text"),s.text(function(t){return t.text}).attr("x",n).attr("y",r).attr("font-size",e).attr("fill",function(t){return t.textStyle.color}).attr("text-anchor",a);var c=o.selectAll(".xc-title-subtext").data([t.titleConfig]);c.enter().append("tspan").attr("class","xc-title-subtext"),c.text(function(t){return t.subtext}).attr("x",n).attr("dy","1.2em").attr("fill",function(t){return t.subtextStyle.color}).attr("font-size",i).attr("text-anchor",a)},updateSeries:function(){}})}(window),function(t){function e(t,e,i){return e.tooltip.show===!1?void(this._show=!1):(this._show=!0,void h.call(this,t,e,i))}function i(t,e){var i=this.axisX,n=this.axisY;return t<i[0]||t>i[1]||e<n[0]||e>n[1]}function n(){var t=this.main.selectAll(".xc-tooltip-line").data([this]);return t.enter().append("line").attr("class","xc-tooltip-line").attr("stroke",this.tooltipConfig.lineColor).attr("stroke-width",this.tooltipConfig.lineWidth).attr("opacity",0),t}function r(t){t.axisX=[],t.axisX[0]=t.margin.left,t.axisX[1]=t.originalWidth-t.margin.right,t.axisY=[],t.axisY[0]=t.margin.top,t.axisY[1]=t.originalHeight-t.margin.bottom}function a(){var t={show:!0,trigger:"axis",lineColor:"#008ACD",lineWidth:2};return t}var o=t.xCharts,s=o.utils,c=t.d3,l=o.components,h=l.Component;s.inherits(e,h),l.extend({tooltip:e}),e.prototype.extend=o.extend,e.prototype.extend({init:function(t,e){this.originalWidth=t.originalWidth,this.originalHeight=t.originalHeight,this.xAxisScale=t.xAxisScale,this.axisX=null,this.axisY=null,this.tooltipWidth=null,this.tooltipHeight=null,this.display=!0,this.tooltipShow=!1,(!this.config.xAxis||this.config.xAxis.length>1||"value"==this.config.xAxis[0].type)&&(this.config.tooltip.trigger="item"),this.tooltipConfig=s.merage(a(),e.tooltip)},render:function(){this.tooltip=this.div.append("div").attr("class","xc-tooltip")},ready:function(){var t=this;if("axis"===t.tooltipConfig.trigger){var e=-1,a=!0,o=-1;t.div.on("mousemove.tooltip",function(){if(t.display!==!1){a&&(a=!1,r(t),t.axisLine=n.call(t));var s=c.mouse(this),l=s[0],h=s[1],d=t.axisLine;if(i.call(t,l,h))return void t.hiddenTooltip();t.tooltipShow||t.showTooltip();var u=t.messageCenter.xAxisScale[0],f=t.config.xAxis[0].data,p=t.originalWidth-t.margin.left-t.margin.right,g=t.originalHeight-t.margin.top-t.margin.bottom,x=f.length-1,v=p/x,m=Math.round((l-t.margin.left)/v);if(m!==e){var y="";t.fire("tooltipSectionChange",m,function(e){y+=e,t.setTooltipHtml(y)},t.tooltipConfig.formatter),o=t.messageCenter.charts.bar?t.messageCenter.charts.bar.getTooltipPosition(m):u(f[m]),d.attr("x1",o).attr("x2",o).attr("y1",0).attr("y2",g),o+=t.margin.left,e=m}t.setPosition([o,h])}}),t.on("tooltipNone",function(){t.display=!1}),t.on("tooltipShow",function(){t.display=!0}),t.div.on("mouseleave.tooltip",function(){t.hiddenTooltip()})}},refresh:function(){return this._show?(this.hiddenTooltip(),this.init(this.messageCenter,this.config,this.type,this.config.series),void this.ready()):!0},updateSeries:function(){},showTooltip:function(){var t=this;t.tooltipShow=!0,t.tooltip.style({visibility:"visible"}),"axis"===this.tooltipConfig.trigger&&t.axisLine.attr("opacity",1)},hiddenTooltip:function(){var t=this;t.fire("tooltipHidden"),t.tooltipShow=!1,t.tooltip.style({visibility:"hidden"}),"axis"===this.tooltipConfig.trigger&&t.axisLine&&t.axisLine.attr("opacity",0),t.main.selectAll(".xc-tooltip-line").attr("opacity",0)},setPosition:function(t,e,i){var n=this;if(n.tooltipShow){e=e||5,i=i||5,n.tooltipWidth||(n.tooltipWidth=n.tooltip.node().clientWidth,n.tooltipWidth=parseFloat(n.tooltipWidth),n.tooltipHeight=n.tooltip.node().clientHeight,n.tooltipHeight=parseFloat(n.tooltipHeight));var r=n.tooltipWidth,a=n.tooltipHeight,o=n.originalWidth,s=n.originalHeight,c=t[0],l=t[1];c+r>o?c=c-r-e:c+=e,l+a>s?l=l-a-i:l+=i,n.tooltip.style({transform:"translate("+c+"px,"+l+"px)"})}},setTooltipHtml:function(t){this.tooltip.html(t)}})}(window),function(t){function e(t,e,i){this.width=t.width,this.height=t.height,this.id=t.id,this.getColor=t.getColor,r.call(this,t,e,i)}var i=t.xCharts,n=i.utils,r=i.components.Component;n.inherits(e,r),e.prototype.extend=i.extend,e.prototype.extend({refresh:function(t,e){this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.width=this.messageCenter.width,this.height=this.messageCenter.height,this.init(this.messageCenter,this.config,this.type,this.config.series),this.render(t,e)}}),i.charts.extend({Chart:e})}(window),function(t){function e(t,e){a.call(this,t,e,"bar")}function i(t,e){var i="";return i+="<div>"+t+"："+e+"</div>"}var n=t.xCharts,r=n.utils,a=n.charts.Chart;n.charts.extend({bar:e}),r.inherits(e,a),e.prototype.extend=n.extend,e.prototype.extend({init:function(t,e,i,n){var r=this;if(!this.barSeries){this.barSeries=[];for(var a=0;a<n.length;a++)"bar"==n[a].type&&this.barSeries.push(n[a]);this.barSeries.forEach(function(t){t.color=r.getColor(t.idx),t.isShow=!0})}this.xAxisScale=t.xAxisScale,this.yAxisScale=t.yAxisScale;for(var a=0;a<this.xAxisScale.length;a++)if("function"==typeof this.xAxisScale[a].rangeBand){this.barXScale=this.xAxisScale[a];break}this.barYScale=this.yAxisScale[0],this.rectsData=this.__getDefaultData();for(var a=0;a<this.barSeries.length;a++)if(!this.barSeries[a].isShow){this.__changeRectsData();break}},render:function(t,e){this.bar=this.__renderBarWrapper(),this.rectWrapperList=this.__renderRectWrapper(),this.rectList=this.__renderRect(t,e)},ready:function(){this.__legendReady(),this.__tooltipReady()},__getDefaultData:function(){var t=this.barXScale.rangeBand(),e=this.barXScale.domain().length,i=this.barXScale.rangeExtent(),n=this.barYScale.range();this.xRange=i[1]-i[0],this.yRange=n[0]-n[1];for(var r=(this.xRange-t*e)/2,a=10,o=this.barSeries.length,s=(t-(o+1)*a)/o,c=[],l=r,h=0;e>h;h++){for(var d=[],u=a,f=0;o>f;f++){var p={x:u,y:this.barYScale(this.barSeries[f].data[h]),width:s>0?s:0,height:this.yRange-this.barYScale(this.barSeries[f].data[h]),color:this.barSeries[f].color};d.push(p),u+=s+a}var g={x:l,y:0,rectsData:d};c.push(g),l+=t}return c},__changeRectsData:function(){for(var t=this.barXScale.rangeBand(),e=10,i=0,n=0;n<this.barSeries.length;n++)this.barSeries[n].isShow&&i++;for(var r=(t-(i+1)*e)/i,n=0;n<this.rectsData.length;n++)for(var a=this.rectsData[n].rectsData,o=e,s=0;s<a.length;s++)this.barSeries[s].isShow?(a[s].x=o,a[s].y=this.barYScale(this.barSeries[s].data[n]),a[s].width=r,a[s].height=this.yRange-this.barYScale(this.barSeries[s].data[n]),o+=r+e):(a[s].y=this.yRange,a[s].height=0)},__renderBarWrapper:function(){var t=this.main.selectAll(".xc-bar").data([1]);return t.enter().append("g").classed("xc-bar",!0),t},__renderRectWrapper:function(){var t=this.bar.selectAll(".xc-bar-rectWrapper").data(this.rectsData);return t.enter().append("g").classed("xc-bar-rectWrapper",!0),t.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),t},__renderRect:function(t,e){var i=this.rectWrapperList.selectAll(".xc-bar-rect").data(function(t){return t.rectsData});return i.enter().append("rect").classed("xc-bar-rect",!0).attr("x",function(t){return t.x}).attr("y",this.yRange).attr("width",function(t){return t.width}).attr("height",0).attr("fill",function(t){return t.color}),i.transition().duration(e).ease(t).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}),i},__legendReady:function(){var t=this;this.on("legendMouseenter.bar",function(e){for(var i=0,n=0;n<t.barSeries.length;n++)if(t.barSeries[n].name==e){i=t.barSeries[n].idx;break}t.rectList.forEach(function(t){d3.select(t[i]).attr("fill-opacity",.5)})}),this.on("legendMouseleave.bar",function(e){for(var i=0,n=0;n<t.barSeries.length;n++)if(t.barSeries[n].name==e){i=t.barSeries[n].idx;break}t.rectList.forEach(function(t){d3.select(t[i]).attr("fill-opacity",null)})}),this.on("legendClick.bar",function(e){var i=t.config.animation;t.barSeries.forEach(function(t){t.isShow=!1});for(var n=0;n<e.length;n++)for(var r=0;r<t.barSeries.length;r++)if(e[n]==t.barSeries[r].name){t.barSeries[r].isShow=!0;break}t.__changeRectsData(),t.__renderRect(i.animationEase,i.animationTime)})},__tooltipReady:function(){var t=this;this.config.tooltip&&this.config.tooltip.show&&"axis"==this.config.tooltip.trigger&&this.on("tooltipSectionChange.bar",function(e,n,r){var a="";t.barSeries.forEach(function(t){if(t.isShow){var n=t.formatter||r||i;a+=n(t.name,t.data[e])}}),n(a)})},getTooltipPosition:function(t){var e=this.barXScale.rangeBand(),i=this.barXScale.domain().length,n=this.barXScale.rangeExtent(),r=(this.xRange-e*i)/2;return n[0]+r+t*e+e/2}})}(window),function(t){function e(t,e){f.call(this,t,e,"funnel")}function i(t,e){return t.forEach(function(t){"funnel"==t.type&&t.data.forEach(function(t){n(t.name,e)?t.show=!0:t.show=!1})}),t}function n(t,e){for(var i,n=0;i=e[n++];)if(t==i)return!0;return!1}function r(t){var e="M";return e+=t[0],e+="L"+t[1],e+="L"+t[2],e+="L"+t[3]}function a(t,e){for(var i,n=[],r=0;i=t[r++];){if("funnel"!=i.type)return;i=u.merage(h(),i),s(i,e),c(i,e),i.funnelPath=o(i),i.data.forEach(function(t,e){t.idx=null==t.idx?e:t.idx,t._serie=i,t.pathArr=i.funnelPath(e);var n=(t.pathArr[0][0]+t.pathArr[1][0])/2,r=(t.pathArr[0][1]+t.pathArr[2][1])/2;t.labelPosition=[n,r],t.labelWidth=t.sectionWidth/2+30}),n.push(i)}return n}function o(t){
var e=t.width,i=t.height,n=t.data,r=t.sort;n.sort(function(t,e){var i=t.value-e.value;return"top"==r?i:-i});var a=n.length,o=-(1/0);n.forEach(function(t){0==t.show&&a--,o=p.max([o,parseFloat(t.value)])});var s=i/a,c="top"==r?1:0,l=[];if(n.forEach(function(t,i){if(t.maxValue=o,t.percentage=parseFloat(t.value)/o,0==t.show)return void(l[i]=void 0);var n=t.percentage*e;t.sectionWidth=n;var r=(e-n)/2;l[i]=[],l[i][0]=[r,s*c],l[i][1]=[r+n,s*c],c++}),"top"==r){var h=[e/2,0];l.unshift([h,h])}else{var d=[e/2,s*c];l.push([d,d])}for(var u=0,f=l.length;f>u;u++){var g=l[u];if(void 0==g)for(var x=1;void 0===l[u];)"top"==r?l[u]=l[u-x]:l[u]=l[u+x],x++}return function(t){(0>t||t>=n.length)&&console.error("内部代码错误,漏斗图获取区块%d，最大值为%d",t,n.length);var e=[];return e[0]=l[t][0],e[1]=l[t][1],e[2]=l[t+1][1],e[3]=l[t+1][0],e}}function s(t,e){var i=e.width,n=e.height,r=t.size,a=r[0];if("string"==typeof a)if("%"===a.substr(-1)){var o=parseFloat(a)/100;a=o*i}else"px"==a.substr(-2)?a=parseFloat(a):(a=parseFloat(a),isNaN(a)&&console.error("name:"+t.name+" size[0] not support"));else"number"!=typeof a&&console.error("name:"+t.name+" size[0] not support");var s=r[1];if("string"==typeof s)if("%"===s.substr(-1)){var o=parseFloat(s)/100;s=o*n}else"px"==s.substr(-2)?s=parseFloat(s):(s=parseFloat(s),isNaN(s)&&console.error("name:"+t.name+" size[1] not support"));else"number"!=typeof s&&console.error("name:"+t.name+" size[1] not support");t.width=a,t.height=s}function c(t,e){var i=e.width,n=e.height,r=t.x,a=t.y,o=0,s=0;"center"==r?o=(i-t.width)/2:"right"==r?o=i-t.width:"%"==r.substr(-1)?o=parseFloat(r)/100*i:(r=parseFloat(r),isNaN(r)?console.error("name:"+t.name+" serie.x not support"):o=r),"middle"==a?s=(n-t.height)/2:"%"==a.substr(-1)?s=parseFloat(a)/100*n:(a=parseFloat(a),isNaN(a)?console.error("name:"+t.name+" serie.y not support"):s=a),t.xOffset=o,t.yOffset=s}function l(t,e,i){return"<p>"+t+":&nbsp;"+e+" 占比:"+i+"%</p>"}function h(){var t={name:"漏斗图",type:"funnel",sort:"down",size:["50%","50%"],x:"center",y:"middle",data:[],itemStyle:{opacity:.5}};return t}var d=t.xCharts,u=d.utils,f=d.charts.Chart,p=t.d3;d.charts.extend({funnel:e}),u.inherits(e,f),e.prototype.extend=d.extend,e.prototype.extend({init:function(t,e,i,n){var r=this;r.series=a(n,r)},render:function(t,e){var i=this,n=i.config.animation,a=i.main.selectAll(".xc-funnel-group").data(i.series);a.enter().append("g").attr("class","xc-funnel-group"),a.exit().remove(),a.attr("transform",function(t){return"translate("+t.xOffset+","+t.yOffset+")"});var o=a.selectAll(".xc-funnel-section").data(function(t){return t.data});o.enter().append("path").attr("class","xc-funnel-section"),o.attr("fill",function(t){return i.getColor(t.idx)}).transition().ease(t).duration(e).attrTween("d",function(t){this.pathArr=void 0===this.pathArr?t.pathArr:this.pathArr;var e=p.interpolate(this.pathArr,t.pathArr);return this.pathArr=t.pathArr,function(t){return r(e(t))}});var s=a.selectAll(".xc-funnel-label").data(function(t){return t.data}),c="opacity "+n.animationTime+"ms linear";s.enter().append("g").attr("class","xc-funnel-label").style("transition",c),s.exit().remove(),s.attr("opacity",function(t){return 0==t.show?0:1}).transition().ease(t).duration(e).attrTween("transform",function(t){this.labelPosition=void 0===this.labelPosition?t.labelPosition:this.labelPosition;var e=p.interpolate(this.labelPosition,t.labelPosition);return this.labelPosition=t.labelPosition,function(t){return"translate("+e(t)+")"}});var l=s.selectAll(".xc-funnel-label-line").data(function(t){return 0!=t.show?[t]:[]});l.enter().append("path").attr("class","xc-funnel-label-line"),l.attr("d",function(t){return"M0,0 L"+t.labelWidth+",0"}).attr("stroke",function(t){return i.getColor(t.idx)});var h=s.selectAll(".xc-funnel-label-text").data(function(t){return 0!=t.show?[t]:[]});h.enter().append("text").attr("class","xc-funnel-label-text"),h.text(function(t){return t.name}).attr("font-size",14).attr("x",function(t){return t.labelWidth+5}).attr("y","0.2em"),i.funnelSection=o},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){var t=this;t.on("legendMouseenter.funnel",function(e){t.funnelSection.attr("opacity",function(t){var i=1;return t.name==e&&(i=t._serie.itemStyle.opacity),i})}),t.on("legendMouseleave.funnel",function(){t.funnelSection.attr("opacity",1)}),t.on("legendClick.funnel",function(e){var n=i(t.config.series,e),r=t.config.animation;t.init(t.series,t.config,t.type,n),t.render(r.animationEase,r.animationTime)})},__tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"!=this.config.tooltip.trigger){var t=this,e=t.messageCenter.components.tooltip,i=e.tooltipConfig.formatter;t.funnelSection.on("mousemove.funnel",function(t){var n=p.event,r=n.layerX||n.offsetX,a=n.layerY||n.offsetY,o=t._serie.formatter||i||l,s="<p>"+t._serie.name+"</p>";e.setTooltipHtml(s+o(t.name,t.value,(100*t.percentage).toFixed(1))),e.setPosition([r,a])}),t.funnelSection.on("mouseenter.funnel",function(t){p.select(this).attr("opacity",t._serie.itemStyle.opacity),e.showTooltip()}),t.funnelSection.on("mouseleave.funnel",function(){p.select(this).attr("opacity",1),e.hiddenTooltip()})}}})}(window),function(t){function e(t,e){d.call(this,t,e,"line")}function i(t,e,i){var a={},o=0,s=[];e.map(function(t){if("line"==t.type){if(t=h.merage(c(),t),t.idx=null==t.idx?o++:t.idx,!t.stack)return void s.push(t);a[t.stack]||(a[t.stack]=[]),a[t.stack].push(t)}});var l=n(t,a,i);return s=r(t,s,i),s.concat(l)}function n(t,e,i){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var a=null,o="linear";e[r].forEach(function(e){if(e.show!==!1){var r=e.xAxisIndex,s=e.yAxisIndex,c=i.xAxis[r],l=(i.yAxis[s],t.xAxisScale[r]),h=t.yAxisScale[s],d=e.idx;e.interpolate=e.smooth?"monotone":"linear",e.y0Interpolate=o,e.xScale=l,e.yScale=h,o=e.interpolate,e.data=e.data.map(function(t,i){var n={};return"value"!=c.type&&(n.x=c.data[i],n.y0=a?a[i].y:h.domain()[0],n.y=parseFloat(t)+(a?a[i].y:0)),n.value=t,n.idx=d,n._serie=e,n}),a=e.data}n.push(e)})}return n}function r(t,e,i){return e=e.map(function(e){if(e.show!==!1){var n=e.xAxisIndex,r=e.yAxisIndex,a=i.xAxis[n],o=(i.yAxis[r],t.xAxisScale[n]),s=t.yAxisScale[r],c=e.idx;e.interpolate=e.smooth?"monotone":"linear",e.y0Interpolate="linear",e.xScale=o,e.yScale=s,e.data=e.data.map(function(t,i){var n={};return"value"!=a.type&&(n.x=a.data[i],n.y=parseFloat(t),n.y0=s.domain()[0]),n.value=t,n.idx=c,n._serie=e,n})}return e})}function a(t,e){var i=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}),n=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y0});i.interpolate(e.interpolate);var r=i(t);n.interpolate(e.y0Interpolate);var a=n(t.reverse());return t.reverse(),o(r,a,t)}function o(t,e,i){var n=i[0],r=i[i.length-1],a=[n.x,n.y],o=[r.x,r.y0];return t+"L"+o+e+"L"+a}function s(t,e){return"<p>"+t+":&nbsp;"+e+"</p>"}function c(){var t={name:"",type:"line",xAxisIndex:0,yAxisIndex:0,smooth:!0,lineStyle:{color:"auto",width:2,radius:5},areaStyle:{show:!1,color:"auto",opacity:.3},data:[],units:""};return t}var l=t.xCharts,h=l.utils,d=l.charts.Chart;l.charts.extend({line:e}),h.inherits(e,d),e.prototype.extend=l.extend,e.prototype.extend({init:function(t,e,n,r){this.xAxisScale=t.xAxisScale,this.yAxisScale=t.yAxisScale,this.series=i(this,r,e),this.timeModel="time"==e.xAxis[0].type},render:function(t,e){this.__renderArea(t,e),this.__renderLine(t,e),this.timeModel||this.__renderCircle(t,e)},__renderLine:function(t,e){var i=this.id,n=this,r="opacity "+e/2+"ms linear",a=this.main.selectAll(".xc-line-group").data([n]);a.enter().append("g").attr("class","xc-line-group"),a.exit().remove();var o=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}),s=a.selectAll(".xc-line-path").data(n.series);s.enter().append("path").attr("class","xc-line-path").attr("fill","none"),s.exit().remove(),s.attr("stroke",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:n.getColor(t.idx)}).attr("stroke-width",function(t){return t.lineStyle.width}).attr("id",function(t){return"xc-line-path-id"+i+"-"+t.idx}).style("transition",r).style("opacity",function(t){return t.show===!1?0:1}),s.transition().duration(e).ease(t).attrTween("d",function(t){var e=this;if(t.show===!1)return function(){return e.linePath};var i=t.data.map(function(e){return{x:t.xScale(e.x),y:t.yScale(e.y)}});this.lineData=void 0==this.lineData?i:this.lineData;var n=d3.interpolate(this.lineData,i);return this.lineData=i,function(i){var r=n(i);o.interpolate(t.interpolate);var a=o(r);return 1==i&&(e.linePath=a),a}})},__renderArea:function(t,e){var i=this.id,n=this,r="opacity "+e/2+"ms linear",o=n.main.selectAll(".xc-area-group").data([n]);o.enter().append("g").attr("class","xc-area-group"),o.exit().remove();var s=o.selectAll(".xc-line-area-path").data(n.series);s.enter().append("path").attr("class","xc-line-area-path").attr("stroke","none"),s.exit().remove(),s.attr("fill",function(t){return"auto"==t.areaStyle.color?"auto"==t.lineStyle.color?n.getColor(t.idx):t.lineStyle.color:t.areaStyle.color}).attr("id",function(t){return"xc-line-area-path-id"+i+"-"+t.idx}).style("transition",r).style("opacity",function(t){return t.show===!1?0:t.areaStyle.opacity}),s.transition().duration(e).ease(t).attrTween("d",function(t){var e=this;if(t.show===!1)return function(){return null==e.areaPath?"":e.areaPath};if(t.areaStyle.show===!1)return function(){return""};var i=t.data.map(function(e){return{x:t.xScale(e.x),y:t.yScale(e.y),y0:t.yScale(e.y0)}});e.areaData=void 0==e.areaData?i:e.areaData;var n=d3.interpolate(this.areaData,i);return e.areaData=i,function(i){var r=n(i),o=a(r,t);return 1==i&&(e.areaPath=o),o}})},__renderCircle:function(t,e){var i=this.id,n=this,r=n.messageCenter.showDomainList[0],a="opacity "+e/2+"ms linear",o=n.main.selectAll(".xc-circle-group").data(n.series);o.enter().append("g").attr("class",function(t){return"xc-circle-group"}),o.exit().remove(),o.attr("id",function(t){return"xc-circle-group-id"+i+"-"+t.idx}).attr("fill",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:n.getColor(t.idx)});var s=o.selectAll("circle").data(function(t){return t.data});s.enter().append("circle").attr("class",function(t,e){return"xc-point xc-point-"+e}),s.exit().remove(),s.style("transition",a).style("opacity",function(t){return"object"!=typeof t?0:1}).style("display",function(t,e){return r[e]!==!0?"none":"block"}).attr("r",function(t){return"object"==typeof t&&(this.circleRadius=t._serie.lineStyle.radius),this.circleRadius}),s.transition().duration(e).ease(t).attrTween("cx",function(t){var e=this;if("object"!=typeof t)return function(){return e.circleCX};var i=t._serie.xScale(t.x);e.circleCX=void 0==e.circleCX?i:e.circleCX;var n=d3.interpolate(e.circleCX,i);return e.circleCX=i,function(t){return n(t)}}).attrTween("cy",function(t){var e=this;if("object"!=typeof t)return function(){return e.circleCY};var i=t._serie.yScale(t.y);e.circleCY=void 0==e.circleCY?i:e.circleCY;var n=d3.interpolate(e.circleCY,i);return e.circleCY=i,function(t){return n(t)}}),n.circleGroup=s},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){function t(t){for(var e,i=r.series,n=0;e=i[n++];)if(e.name==t)return e}var e,i,n,r=this,a=r.id;this.on("legendMouseenter.line",function(o){e=r.main.selectAll(".xc-line-use").data([r]),i=r.main.selectAll(".xc-line-area-use").data([r]),n=r.main.selectAll(".xc-circle-use").data([r]),e.enter().append("use").attr("class","xc-line-use"),i.enter().append("use").attr("class","xc-line-area-use"),n.enter().append("use").attr("class","xc-circle-use");var s=t(o);if(s){var c="#xc-line-path-id"+a+"-"+s.idx,l="#xc-line-area-path-id"+a+"-"+s.idx,h="#xc-circle-group-id"+a+"-"+s.idx;e.attr("xlink:href",c),i.attr("xlink:href",l),n.attr("xlink:href",h),d3.select(c).attr("stroke-width",s.lineStyle.width+1)}}),this.on("legendMouseleave.line",function(r){var o=t(r);if(o){var s="#xc-line-path-id"+a+"-"+o.idx,c=("#xc-line-area-path-id"+a+"-"+o.idx,"#xc-circle-group-id"+a+"-"+o.idx);e.attr("xlink:href",""),i.attr("xlink:href",""),n.attr("xlink:href",""),d3.select(s).attr("stroke",o.color).attr("stroke-width",o.lineStyle.width),d3.select(c).attr("fill",o.color)}}),this.on("legendClick.line",function(t){var e=r.config.series,i=r.config.animation;r.init(r.messageCenter,r.config,r.type,e),r.render(i.animationEase,i.animationTime)})},__tooltipReady:function(){var t=this;if(this.config.tooltip&&this.config.tooltip.show!==!1)if("axis"==this.config.tooltip.trigger)this.on("tooltipSectionChange.line",function(e,i,n){var r="",a=t.series;t.timeModel&&(t.main.selectAll(".xc-tooltip-circle").remove(),t.series.forEach(function(i){var n=i.data[e];t.main.append("circle").datum(n).attr("class","xc-tooltip-circle").attr("r",function(t){return t._serie.lineStyle.radius}).attr("cx",function(t){return t._serie.xScale(t.x)}).attr("cy",function(t){return t.yScale(t.y)}).attr("fill",function(t){return t._serie.color})})),a.forEach(function(t){if(t.show!==!1){var i=void 0===t.data[e]?"":t.data[e].value,a=t.formatter||n||s;r+=a(t.name,i)}}),i(r)}),this.on("tooltipHidden",function(){t.main.selectAll(".xc-tooltip-circle").remove()});else{var e=t.messageCenter.components.tooltip,i=e.tooltipConfig.formatter,n=t.messageCenter.components.xAxis.axisConfig;t.circleGroup.on("mouseenter",function(t){var r=d3.event.srcElement||d3.event.target;r=d3.select(r);var t=r.data()[0],a=t.value,o=t._serie.name,c=t._serie.formatter||i||s,l=c(o,a),h=t.x;h=n[t._serie.xAxisIndex].tickFormat(h);var d="<p>"+h+"</p>";e.show(),e.setTooltipHtml(d+l);var u=d3.event,f=u.layerX||u.offsetX,p=u.layerY||u.offsetY;e.setPosition([f,p])}),t.circleGroup.on("mouseleave",function(){e.hidden()})}}})}(window),function(t){function e(t,e){a.call(this,t,e,"pie")}function i(t,e){return"<div>"+t+"："+e+"</div>"}var n=t.xCharts,r=n.utils,a=n.charts.Chart;n.charts.extend({pie:e}),r.inherits(e,a),e.prototype.extend=n.extend,e.prototype.extend({init:function(t,e,i,n){if(this.pieConfig){for(var a=0;a<n.length;a++)if("pie"==n[a].type){this.pieConfig.center=r.copy(n[a].center,!0),this.pieConfig.radius=r.copy(n[a].radius,!0);break}}else{this.pieConfig={};for(var a=0;a<n.length;a++)if("pie"==n[a].type){this.pieConfig=r.copy(n[a],!0);break}}this.__correctConfig(),this.pieData=this.__getPieData(),this.arcFunc=this.__getArcFunc(),this.bigArcFunc=this.__getBigArcFunc()},render:function(t,e){this.pieWrapper=this.__renderPieWrapper(),this.arcList=this.__renderArcs(t,e)},ready:function(){this.__legendReady(),this.__tooltipReady()},__correctConfig:function(){var t=this.pieConfig.center;"string"==typeof t[0]&&(t[0]=.01*parseInt(t[0])*this.width),"string"==typeof t[1]&&(t[1]=.01*parseInt(t[1])*this.height);var e=this.pieConfig.radius;e.innerRadius?"string"==typeof e.innerRadius&&(e.innerRadius=.01*parseInt(e.innerRadius)*this.width):e.innerRadius=0,"string"==typeof e.outerRadius&&(e.outerRadius=.01*parseInt(e.outerRadius)*this.width);var i=this.width<this.height?this.width:this.height;2*e.outerRadius>i&&(e.outerRadius=i/2),this.pieConfig.data.forEach(function(t){t.isShow=!0,t.initialValue=t.value})},__getPieData:function(){var t=d3.layout.pie().sort(null).value(function(t,e){return t.value}),e=t(this.pieConfig.data);return e},__getArcFunc:function(){var t=d3.svg.arc().innerRadius(this.pieConfig.radius.innerRadius).outerRadius(this.pieConfig.radius.outerRadius);return t},__getBigArcFunc:function(){var t=d3.svg.arc().innerRadius(this.pieConfig.radius.innerRadius).outerRadius(this.pieConfig.radius.outerRadius+10);return t},__renderPieWrapper:function(){var t=this.main.selectAll(".xc-pie").data([1]);return t.enter().append("g").classed("xc-pie",!0),t.attr("transform","translate("+this.pieConfig.center[0]+","+this.pieConfig.center[1]+")"),t},__renderArcs:function(t,e){var i=this,n=this.pieWrapper.selectAll(".xc-pie-arcs").data([1]);n.enter().append("g").classed("xc-pie-arcs",!0);var r=n.selectAll(".xc-pie-arc").data(this.pieData);return r.enter().append("path").classed("xc-pie-arc",!0).style("fill",function(t){return t.data.color||(t.data.color=i.getColor(t.data.idx)),t.data.color}),r.transition().duration(e).ease(t).attrTween("d",function(t){this._current=this._current||{startAngle:0,endAngle:0};var e=d3.interpolate(this._current,t);return this._current=e(1),function(t){return i.arcFunc(e(t))}}),r},__legendReady:function(){var t=this;this.on("legendMouseenter.pie",function(e){for(var i=0;i<t.arcList[0].length;i++){var n=d3.select(t.arcList[0][i]);if(n.datum().data.name==e){n.attr("d",function(e){return t.bigArcFunc(e)});break}}}),this.on("legendMouseleave.pie",function(e){for(var i=0;i<t.arcList[0].length;i++){var n=d3.select(t.arcList[0][i]);if(n.datum().data.name==e){n.attr("d",function(e){return t.arcFunc(e)});break}}}),this.on("legendClick.pie",function(e){var i=t.config.animation;if(e.length){t.pieConfig.data.forEach(function(t){t.isShow=!1,t.value=0});for(var n=0;n<e.length;n++)for(var r=e[n],a=0;a<t.pieConfig.data.length;a++)if(t.pieConfig.data[a].name==r){t.pieConfig.data[a].isShow=!0,t.pieConfig.data[a].value=t.pieConfig.data[a].initialValue;break}t.pieData=t.__getPieData()}else t.pieData.forEach(function(t){t.startAngle=0,t.endAngle=0});t.__renderArcs(i.animationEase,i.animationTime)})},__tooltipReady:function(){var t=this;if(this.config.tooltip&&this.config.tooltip.show){var e=t.messageCenter.components.tooltip;this.arcList.on("mousemove.pie",function(){var n=d3.select(this).datum(),r=d3.event,a=r.layerX||r.offsetX,o=r.layerY||r.offsetY,s=e.tooltipConfig.formatter,c=t.pieConfig.formatter,l=c||s||i;e.setTooltipHtml(l(n.data.name,n.data.value)),e.setPosition([a,o],10,10),e.showTooltip(),d3.select(this).attr("d",function(e){return t.bigArcFunc(e)})}),this.arcList.on("mouseout.pie",function(){e.hiddenTooltip(),d3.select(this).attr("d",function(e){return t.arcFunc(e)})})}}})}(window),function(t){function e(t,e){a.call(this,t,e,"radar")}function i(t,e){var i="";i+="<h3>"+t+"</h3>";for(var n=0;n<e.length;n++)i+="<div>"+e[n].name+"："+e[n].value+"</div>";return i}var n=t.xCharts,r=n.utils,a=n.charts.Chart;n.charts.extend({radar:e}),r.inherits(e,a),e.prototype.extend=n.extend,e.prototype.extend({init:function(t,e,i,n){if(this.radarConfig){for(var a=0;a<n.length;a++)if("radar"==n[a].type){this.radarConfig.center=r.copy(n[a].center,!0),this.radarConfig.radius=n[a].radius;break}}else{this.radarConfig={};for(var a=0;a<n.length;a++)if("radar"==n[a].type){this.radarConfig=r.copy(n[a],!0);break}}this.polygonWebs=this.__getPolygonWebs(),this.areas=this.__getAreas(),this.textPoints=this.__getTextPoints(),this.coverPolygons=this.__getCoverPolygons()},render:function(t,e){this.radar=this.__renderRadarWrapper(),this.webList=this.__renderWebs(),this.lineList=this.__renderLines(),this.areaList=this.__renderAreas(t,e),this.textList=this.__renderText(),this.coverPolygonList=this.__renderCoverPolygons()},ready:function(){this.__legendReady(),this.__tooltipReady()},__getPolygonWebs:function(){"string"==typeof this.radarConfig.center[0]&&(this.radarConfig.center[0]=.01*parseFloat(this.radarConfig.center[0])*this.width),"string"==typeof this.radarConfig.center[1]&&(this.radarConfig.center[1]=.01*parseFloat(this.radarConfig.center[1])*this.height),"string"==typeof this.radarConfig.radius&&(this.radarConfig.radius=.01*parseFloat(this.radarConfig.radius)*this.width);var t=this.width<this.height?this.width:this.height;2*this.radarConfig.radius+20>t&&(this.radarConfig.radius=t/2-20),this.radarConfig.total=this.radarConfig.data[0].value.length;for(var e=2*Math.PI/this.radarConfig.total,i=[],n=this.radarConfig.levels;n>0;n--){for(var r="",a=[],o=this.radarConfig.radius/this.radarConfig.levels*n,s=0;s<this.radarConfig.total;s++){var c=o*Math.sin(s*e),l=o*Math.cos(s*e);r+=c+","+l+" ",a.push({x:c,y:l})}i.push({webString:r,webPoints:a})}return i},__getAreas:function(){for(var t=[],e=0;e<this.radarConfig.data.length;e++){for(var i=this.radarConfig.data[e],n=this.radarConfig.indicator[e].max,r=this.radarConfig.indicator[e].min,a="",o=[],s=0;s<i.value.length;s++){var c=this.polygonWebs[0].webPoints[s].x*i.value[s]/(n-r),l=this.polygonWebs[0].webPoints[s].y*i.value[s]/(n-r);a+=c+","+l+" ",o.push({x:c,y:l,originalData:i})}t.push({areaString:a,areaPoints:o,originalData:i,isShow:!0})}return t},__getTextPoints:function(){for(var t=[],e=this.radarConfig.radius+20,i=0;i<this.radarConfig.total;i++)t.push({x:e/this.radarConfig.radius*this.polygonWebs[0].webPoints[i].x,y:e/this.radarConfig.radius*this.polygonWebs[0].webPoints[i].y+8});return t},__getCoverPolygons:function(){for(var t=this.polygonWebs[0].webPoints,e=[],i=t.length,n=0;i>n;n++){var r=0==n?t[i-1]:t[n-1],a=t[n],o=t[(n+1)%i],s="0,0",c=[{x:0,y:0}];s+=" "+(r.x+a.x)/2+","+(r.y+a.y)/2,c.push({x:(r.x+a.x)/2,y:(r.y+a.y)/2}),s+=" "+a.x+","+a.y,c.push({x:a.x,y:a.y}),s+=" "+(a.x+o.x)/2+","+(a.y+o.y)/2,c.push({x:(a.x+o.x)/2,y:(a.y+o.y)/2}),e.push({pointsStr:s,points:c,index:n})}return e},__renderRadarWrapper:function(){var t=this.main.selectAll(".xc-radar").data([1]);return t.enter().append("g").classed("xc-radar",!0),t.attr("transform","translate("+this.radarConfig.center[0]+","+this.radarConfig.center[1]+")"),t},__renderWebs:function(){var t=this.radar.selectAll(".xc-radar-webs").data([1]);t.enter().append("g").classed("xc-radar-webs",!0);var e=t.selectAll(".xc-radar-web").data(this.polygonWebs);return e.enter().append("polygon").classed("xc-radar-web",!0),e.attr("points",function(t){return t.webString}),e},__renderLines:function(){var t=this.radar.selectAll(".xc-radar-lines").data([1]);t.enter().append("g").classed("xc-radar-lines",!0);var e=t.selectAll(".xc-radar-line").data(this.polygonWebs[0].webPoints);return e.enter().append("line").classed("xc-radar-line",!0),e.attr({x1:0,y1:0,x2:function(t){return t.x},y2:function(t){return t.y}}),e},__renderAreas:function(t,e){var i=this,n=this.radar.selectAll(".xc-radar-areas").data([1]);n.enter().append("g").classed("xc-radar-areas",!0);var r=n.selectAll(".xc-radar-area").data(this.areas);r.enter().append("g").attr("class",function(t,e){return"xc-radar-area xc-radar-area"+t.originalData.idx});var a=r.selectAll("polygon").data(function(t){return[t]});a.enter().append("polygon").attr("points",function(t){return Array.apply(0,Array(i.radarConfig.total)).map(function(){return"0,0"}).join(" ")}).style({stroke:function(t){return t.originalData.color||(t.originalData.color=i.getColor(t.originalData.idx)),t.originalData.color},fill:this.radarConfig.fill?function(t){return t.originalData.color}:""}),a.transition().duration(e).ease(t).attr("points",function(t){return t.areaString});var o=r.selectAll(".xc-radar-area-point").data(function(t){return t.areaPoints});return o.enter().append("circle").classed("xc-radar-area-point",!0).attr({cx:0,cy:0}).style("stroke",function(t){return t.originalData.color}),o.transition().duration(e).ease(t).attr({cx:function(t){return t.x},cy:function(t){return t.y}}),r},__renderText:function(){var t=this,e=this.radar.selectAll(".xc-radar-texts").data([1]);e.enter().append("g").classed("xc-radar-texts",!0);var i=e.selectAll(".xc-radar-text").data(this.textPoints);return i.enter().append("text").classed("xc-radar-text",!0).text(function(e,i){return t.radarConfig.indicator[i].text}).attr("text-anchor","middle"),i.attr({x:function(t){return t.x},y:function(t){return t.y}}),i},__renderCoverPolygons:function(){var t=this.radar.selectAll(".xc-radar-coverPolygons").data([1]);t.enter().append("g").classed("xc-radar-coverPolygons",!0);var e=t.selectAll(".xc-radar-coverPolygon").data(this.coverPolygons);return e.enter().append("polygon").classed("xc-radar-coverPolygon",!0),e.attr("points",function(t){return t.pointsStr}),e},__legendReady:function(){var t=this,e=t.areas;this.on("legendMouseenter.radar",function(i){for(var n={},r=0;r<e.length;r++)if(i==e[r].originalData.name){n=e[r];break}for(var r=0;r<t.areaList[0].length;r++){var a=d3.select(t.areaList[0][r]);if(a.datum()==n){a.selectAll(".xc-radar-area-point").style("stroke-width",5);break}}}),this.on("legendMouseleave.radar",function(i){for(var n={},r=0;r<e.length;r++)if(i==e[r].originalData.name){n=e[r];break}for(var r=0;r<t.areaList[0].length;r++){var a=d3.select(t.areaList[0][r]);if(a.datum()==n){a.selectAll(".xc-radar-area-point").style("stroke-width",3);break}}}),this.on("legendClick.radar",function(e){for(var i=0;i<t.areas.length;i++)t.areas[i].isShow=!1;for(var i=0;i<e.length;i++)for(var n=0;n<t.areas.length;n++)if(e[i]==t.areas[n].originalData.name){t.areas[n].isShow=!0;break}for(var i=0;i<t.areas.length;i++)d3.select(t.areaList[0][i]).classed("hidden",!t.areas[i].isShow)})},__tooltipReady:function(){var t=this;if(this.config.tooltip&&this.config.tooltip.show){var e=t.messageCenter.components.tooltip;this.coverPolygonList.on("mousemove.radar",function(){for(var n=d3.select(this).datum().index,r=d3.event,a=r.layerX||r.offsetX,o=r.layerY||r.offsetY,s=e.tooltipConfig.formatter,c=t.radarConfig.formatter,l=c||s||i,h=t.radarConfig.indicator[n].text,d=[],u=0;u<t.radarConfig.data.length;u++)t.areas[u].isShow&&d.push({name:t.radarConfig.data[u].name,value:t.radarConfig.data[u].value[n]});e.setTooltipHtml(l(h,d)),e.setPosition([a,o],10,10),e.showTooltip();for(var f=t.areaList.selectAll(".xc-radar-area-point"),u=0;u<f.length;u++){var p=f[u];d3.select(p[n]).style("stroke-width",5)}}),this.coverPolygonList.on("mouseout.radar",function(){e.hiddenTooltip();for(var i=d3.select(this).datum().index,n=t.areaList.selectAll(".xc-radar-area-point"),r=0;r<n.length;r++){var a=n[r];d3.select(a[i]).style("stroke-width",3)}})}}})}(window),function(t){function e(t,e){l.call(this,t,e,"scatter")}function i(t,e){for(var i,n=0;i=t[n++];)if(i.name==e)return i}function n(t,e,i){for(var n,r=[],a=0;n=t[a++];)if("scatter"==n.type){n=c.merage(o(),n);var s=n.size;n.idx=null==n.idx?a-1:n.idx,n.xScale=e[n.xAxisIndex],n.yScale=i[n.yAxisIndex],n.data=n.data.map(function(t,e){var i="function"==typeof s?s(t):s,r={};return r.data=t,r.radius=i,r._serie=n,r}),r.push(n)}return r}function r(t){var e=[];return t.forEach(function(t){e=e.concat(t.data)}),e=e.sort(function(t,e){return e.radius-t.radius})}function a(t,e,i){var n="<p>"+t+"</p>";return n+="<p>"+e+","+i+"</p>"}function o(){var t={name:"业绩",type:"scatter",data:[],size:5,xAxisIndex:0,yAxisIndex:0,opacity:.6};return t}var s=t.xCharts,c=s.utils,l=s.charts.Chart,h=t.d3;s.charts.extend({scatter:e}),c.inherits(e,l),e.prototype.extend=s.extend,e.prototype.extend({init:function(t,e,i,a){var o=this;o.xAxisScale=t.xAxisScale,o.yAxisScale=t.yAxisScale,o.series=n(a,o.xAxisScale,o.yAxisScale),o.data=r(o.series)},render:function(t,e){var i=this,n=i.config.animation,r=i.main.selectAll(".xc-scatter-group").data([1]);r.enter().append("g").attr("class","xc-scatter-group");var a=r.selectAll(".xc-scatter-item").data(i.data),o="r "+n.animationTime+"ms linear,cx "+e+"ms linear,cy "+e+"ms linear";a.enter().append("circle"),a.exit().remove(),a.style("transition",o).attr("cx",function(t){return t._serie.xScale(t.data[0])}).attr("cy",function(t){return t._serie.yScale(t.data[1])}).attr("r",function(t){return 0!=t._serie.show?t.radius:0}).attr("fill",function(t){return i.getColor(t._serie.idx)}).attr("opacity",function(t){return t._serie.opacity}).attr("class",function(t){var e="xc-scatter-item";return e+=" xc-scatter-group-"+t._serie.idx}),i.scatterItem=a},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){var t=this,e=null;t.on("legendMouseenter.scatter",function(n){var r=i(t.series,n);e=t.main.selectAll(".xc-scatter-group-"+r.idx),e.attr("opacity",1)}),t.on("legendMouseleave.scatter",function(t){e.attr("opacity",function(t){return t._serie.opacity})}),this.on("legendClick.scatter",function(e){var i=t.config.series;t.init(t.messageCenter,t.config,t.type,i),t.render("linear",0)})},__tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"!=this.config.tooltip.trigger){var t=this,e=t.messageCenter.components.tooltip,i=e.tooltipConfig.formatter;t.scatterItem.on("mouseenter.scatter",function(t){h.select(this).attr("opacity",1);var n=h.event,r=n.layerX||n.offsetX,o=n.layerY||n.offsetY,s=t._serie.formatter||i||a;e.showTooltip(),e.setTooltipHtml(s(t._serie.name,t.data[0],t.data[1])),e.setPosition([r,o])}),t.scatterItem.on("mouseleave.scatter",function(t){h.select(this).attr("opacity",function(t){return t._serie.opacity}),e.hiddenTooltip()})}}})}(window),xCharts});