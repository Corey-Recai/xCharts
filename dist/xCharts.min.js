/**
 * xg-xcharts - charts base on d3.js
 * @version v0.1.5
*/
!function(t,i){"function"==typeof define&&define.amd?define([],function(){return t.xCharts=i()}):"object"==typeof exports?module.exports=i():t.xCharts=i()}(this,function(){function t(i){return c?new t.prototype.init(i):void console.error("The library depends on d3js http://d3js.org/ ")}function i(t,i,e){var n=getComputedStyle(t),r=n[i];return e?parseFloat(r):r}function e(t){var e=i(t,"width",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderLeftWidth",!0)-i(t,"paddingLeft",!0)-i(t,"paddingRight",!0)-i(t,"borderRightWidth",!0)}function n(t){var e=i(t,"height",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderTopWidth",!0)-i(t,"paddingTop",!0)-i(t,"paddingBottom",!0)-i(t,"borderBottomWidth",!0)}function r(t,i){var e={};i.getColor;t.forEach(function(t){var i=t.type;e[i]=void 0==e[i]?e[i]=[]:e[i],e[i].push(t)});for(var n in e)if(e.hasOwnProperty(n))switch(n){case"line":case"scatter":case"bar":e[n].forEach(function(t,i){t.idx=i});break;case"pie":case"funnel":case"radar":e[n].forEach(function(t){t.data.forEach(function(t,i){t.idx=i})});break;default:console.error("type=%d not supported")}}function o(i){var e=t.utils;this.config=e.copy(i,!0),this.getColor=e.getColor(i.color),this.config.animation&&this.config.animation.enable?this.config.animation=e.merage(e.copy(u),this.config.animation):(this.config.animation=e.copy(u),this.config.animation.animationTime=0)}function a(t){var i=t.attr("xcharts-id"),e=f[i];e.fire("chartRemoveBind"),delete f[i]}function s(){for(var t=navigator.userAgent,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],e=!0,n=0;n<i.length;n++)if(t.indexOf(i[n])>0){e=!1;break}return!e}var c=window.d3,l=1,h=s();t.extend=t.prototype.extend=function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])};var f={};t.prototype.extend({init:function(i){i=c.select(i);var r=i.select(".xc-container");r.node()&&a(r),i.html(""),this.mobileMode=h,this.container=i,this.originalWidth=e(i.node()),this.originalHeight=n(i.node()),this.id=l++,this.div=i.append("div").attr("class","xc-container"),this.svg=this.div.append("svg").attr("class","xc-svg").attr("width",this.originalWidth).attr("height",this.originalHeight),this.defs=this.svg.append("defs"),this.clippath=this.defs.append("clipPath").attr("id","xc-firstdraw-"+this.id),this.firstDrawingRect=this.clippath.append("rect").attr("x",0).attr("y",0).attr("width",0).attr("height",this.originalHeight),this.svg.attr("clip-path","url(#xc-firstdraw-"+this.id+")"),this.main=this.svg.append("g").attr("class","xc-main"),this.margin={top:15,left:10,right:15,bottom:30},this.originMargin=t.utils.copy(this.margin),this.EventList={};var o=Math.random().toString(36).substr(2);return this.div.attr("xcharts-id",o),f[o]=this,this},loadConfig:function(t){o.call(this,t),this.firstDrawing(this.config)},firstDrawing:function(i){var e,n=["title","tooltip","legend","yAxis","xAxis","resize"],o=0;for(this.components={},this.charts={};e=n[o++];)if(i[e]&&!this.components[e]){var a=t.components[e];"xAxis"!=e&&"yAxis"!=e||(a=t.components.axis),a?this.components[e]=new a(this,i,e):console.warn("components/%s.js is not loaded!",e.match(/Axis/)?"axis":e)}r(i.series,this),this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.main.attr("transform","translate("+this.margin.left+","+this.margin.top+")"),i.series||(i.series=[]);for(var s,o=0;s=i.series[o++];){var c=s.type;if(!this.charts[c]){var l=t.charts[c];l?this.charts[c]=new l(this,i):console.warn("charts/%s.js is not loaded!",c)}}var h;h=this.config.animation.enable?"width "+this.config.animation.animationTime+"ms linear":"width 0ms linear",this.firstDrawingRect.style("transition",h),this.firstDrawingRect.style("width",this.originalWidth);var f=this;setTimeout(function(){f.svg.attr("clip-path","")},this.config.animation.animationTime+100)},refresh:function(){if(this.originalWidth=e(this.container.node()),this.originalHeight=n(this.container.node()),isNaN(this.originalWidth)||isNaN(this.originalHeight))throw"container not found";this.margin=t.utils.copy(this.originMargin),this.svg.attr("width",this.originalWidth).attr("height",this.originalHeight);var i=this.refreshAnimationTime,r=this.refreshAnimationEase,o=this.components,a=this.charts;for(var s in o)if(o.hasOwnProperty(s)){var c=o[s];c.refresh(r,i)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var s in a)if(a.hasOwnProperty(s)){var l=a[s];l.refresh(r,i)}},_updateSeries:function(i){this.config.series=t.utils.copy(i,!0),this.margin=t.utils.copy(this.originMargin);var e=this.components,n=this.charts;for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];o.updateSeries(this.config.series)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var r in n)if(n.hasOwnProperty(r)){var a=n[r];a.updateSeries(this.config.series)}},on:function(t,i){var e=this.EventList,n=t.split("."),r=n[0],o=n[1]?n[1]:"default";e[r]||(e[r]=[]);for(var a,s=0;a=e[r][s++];)if(a.nameSpace==o){e[r].splice(s-1,1);break}e[r].push({nameSpace:o,callback:i})},fire:function(t){var i=Array.prototype.slice.call(arguments,1),e=this.EventList[t];e&&e.forEach(function(t){t.callback.apply("",i)})}}),t.prototype.init.prototype=t.prototype,t.extend({charts:{extend:t.extend},components:{extend:t.extend},utils:{extend:t.extend}});var u={enable:!1,animationTime:500,animationEase:"linear"};return function(t){function i(t,i){if(!t)return t;var e=l.getType(t);if("Object"==e||"Array"==e){var n,r="Object"==e?{}:[];for(var o in t)t.hasOwnProperty(o)&&(n=t[o],i&&(l.isObject(n)||l.isArray(n))?r[o]=arguments.callee(n,!0):r[o]=t[o]);return r}return t}function e(t,i){var e;for(var n in i)if(i.hasOwnProperty(n)){if(e=i[n],l.isObject(e))t[n]=t[n]||{};else{if(!l.isArray(e)){t[n]=i[n];continue}t[n]=t[n]||[]}arguments.callee(t[n],i[n],!0)}return t}function n(t,i){function e(){this.superClass=i.prototype}t.prototype;e.prototype=i.prototype,t.prototype=new e,t.constructor=t}function r(t){return t}function o(t){return t||Array.isArray(t)||(t=["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]),function(i){return t[i%t.length]}}function a(t,i,e,n){Array.isArray(t)||(t=[t]),void 0===e&&(e=0),void 0===n&&(n=0);var r=document.createElement("span");r.style.fontSize=i+"px",r.style.margin="0px",r.style.padding="0px",r.style.border="none",r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r);var o=[],a=[];return t.forEach(function(t){void 0===r.innerText?r.textContent=t:r.innerText=t;var i=parseFloat(r.offsetWidth)+e,s=parseFloat(r.offsetHeight)+n;o.push(i),a.push(s)}),document.body.removeChild(r),{widthList:o,heightList:a}}function s(t,i,e,n){var r,o,a,s=+new Date,c=0,l=0,h=null,f=function(){l=s,t.apply(o,a)};return function(){s=+new Date,o=this,a=arguments,r=s-(n?c:l)-i,clearTimeout(h),n?e?h=setTimeout(f,i):r>=0&&f():r>=0?f():e&&(h=setTimeout(f,-r)),c=s}}function c(t,i,e){return s(t,i,e,!0)}var l=t.utils,h=Object.prototype.toString,f=["Arguments","Object","Array","Function","String","Number","Date","RegExp","Error"];f.forEach(function(t){l["is"+t]=function(i){return h.call(i)==="[object "+t+"]"}}),l.getType=function(t){var i=h.call(t),e=i.match(/\[object\s(\w+?)\]/)[1];return e},l.copy=i,l.merage=e,l.inherits=n,l.loop=r,l.getColor=o,l.calcTextWidth=a,l.throttle=s,l.debounce=c}(t),function(t){function i(t,i,e){this.messageCenter=t,this.config=i,this.type=e,this.main=t.main,this.margin=t.margin,this.svg=t.svg,this.div=t.div,this.init(t,i,e,this.config.series),this.render("linear",0),this.ready()}i.prototype={constructor:i,init:function(t,i,e){},render:function(t,i){},ready:function(){},refresh:function(t,i){return this._show?(this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.init(this.messageCenter,this.config,this.type,this.config.series),void this.render(t,i)):!0},updateSeries:function(t){return this._show?(this.init(this.messageCenter,this.config,this.type,t),this.render("linear",0),void this.ready()):!0},on:function(){this.messageCenter.on.apply(this.messageCenter,arguments)},fire:function(){this.messageCenter.fire.apply(this.messageCenter,arguments)}},t.components.extend({Component:i})}(t),function(t,i){function e(t,i,e){this._show=!0,g.Component.call(this,t,i,e)}function n(t,i){t.forEach(function(t){"value"===t.scaleType||"time"===t.scaleType?t.range(i):"barCategory"===t.scaleType?t.rangeRoundBands(i,0,.1):"category"===t.scaleType&&t.rangeRoundPoints(i)})}function r(t,e,n,r){if(e){var o=r.domain().map(function(t){return n.tickFormat(t)}),a=p.calcTextWidth(o,14).widthList,s=a[a.length-1],c=t.margin.right;s/2>c&&(t.margin.right+=Math.round(s/2)-c);var l=a[0],h=t.margin.left;l/2>h&&(t.margin.left+=Math.round(l/2)-h)}else{var o=r.ticks().map(function(t){return n.tickFormat(t)}),a=p.calcTextWidth(o,14).widthList,f=i.max(a);f=void 0==f?0:f,"right"===n.position?t.margin.right+=f:t.margin.left+=f}}function o(t,i,e){var n=x[t.type];return n?n.call(e,t,i):void console.error('axis[%d].type = "%s" is not supported',i,t.type)}function a(t,e){if(!t.data)return void console.error("axis[%d].data is not defined!",e);if(f(this.config.series)){var n=i.scale.ordinal().domain(t.data);n.scaleType="barCategory"}else{var n=i.scale.ordinal().domain(t.data);n.scaleType="category"}return n}function s(t,e){var n=this.series,r=this.type;n.map(function(t){null==t[r+"Index"]&&(t[r+"Index"]=0)});var o=[],a=[];for(var s in m)if(m.hasOwnProperty(s)){var c=m[s](n,r,e);c&&o.push(c)}a[0]=i.min(o,function(t){return t[0]}),a[1]=i.max(o,function(t){return t[1]}),a[0]===a[1]&&null!=a[0]&&null!=a[1]&&(a[0]>0?a[0]=0:a[1]=0),a[0]>t.minValue&&(a[0]=t.minValue),a[1]<t.maxValue&&(a[1]=t.maxValue);var l=i.scale.linear().domain(a);if(l.scaleType="value",t.ticks<2||this.legendRefresh){var h=l.ticks().length,f=Math.ceil(h/2);f>=2&&(t.ticks=f)}var f=l.ticks(t.ticks),u=f[1]-f[0];return a[0]%u===0||isNaN(u)||(a[0]=parseInt(a[0]/u)*u),a[1]%u===0||isNaN(u)||(a[1]=(parseInt(a[1]/u)+1)*u),l.domain(a),l}function c(t,e){var n=i.time.scale().domain(i.extent(t.data,function(t){return+new Date(t)}));if(this.isXAxis){for(var r,o=this.config.series,a=1,s=0;r=o[s++];){var c=void 0==r.xAxisIndex?0:r.xAxisIndex;if("line"==r.type&&c==e){a=r.data.length-1;break}}var l=n.domain(),h=l[1]-l[0],f=h/a;t.data=[+l[0]];for(var s=0;a>s;s++)t.data[s+1]=+l[0]+Math.round(f*(s+1),1)}return n.scaleType="time",n}function l(t,i){for(var e=[],n=0;n<t.length;n++){var r=t[n];if("category"===r.scaleType||"barCategory"===r.scaleType){for(var o=p.copy(r.domain()),a=r.range(),s=i[n],c=o.map(function(t){return s.tickFormat(t)}),l=p.calcTextWidth(c,14).widthList,h=parseInt((a[a.length-1]-a[0])/(o.length-1)),f=0,u=1,d=1;d<l.length;d++){var g=l[f],x=l[u];(g+x)/2>h*(d-f)?o[d]=null:(u=d+1,f=d)}o=o.filter(function(t){return null!==t}),e.push(o)}}return e}function h(t){var i=t.position,e=[0,0];return"right"==i?e=[this.width,0]:"bottom"==i&&(e=[0,this.height]),"translate("+e+")"}function f(t){for(var i,e=0;i=t[e++];)if("bar"===i.type)return!0;return!1}function u(t,i){for(var e=[],n=0;n<t.length;n++){var r=t[n],o=i[n].data,a={};r.forEach(function(t){for(var i=0;i<o.length&&t!==o[i];i++);i==o.length&&console.error("data和value不匹配"),a[i]=!0}),e[n]=a}return e}function d(t){var i={tickFormat:p.loop,ticks:-1,formatter:function(t){return"<p>"+this.tickFormat(t)+"</p>"},position:"xAxis"==t?"bottom":"left",show:!0};return i}var p=t.utils,g=t.components;p.inherits(e,g.Component),g.extend({axis:e}),e.prototype.extend=t.extend,e.prototype.extend({init:function(t,i,e,a){this.isXAxis="xAxis"===e,this.axisConfig=i[e],this.series=a;for(var s=[],c=0;c<this.axisConfig.length;c++){var i=p.merage(d(e),this.axisConfig[c]),h=o(i,c,this),f=h.domain();isNaN(f[0])&&isNaN(f[1])&&"value"===h.scaleType&&(h=this.scales[c]),this.legendRefresh||r(this,this.isXAxis,i,h),this.axisConfig[c]=i,s[c]=h,this.axisConfig[c]=i}this.width=t.originalWidth-t.margin.left-t.margin.right,this.height=t.originalHeight-t.margin.top-t.margin.bottom,this.range=this.isXAxis?[0,this.width]:[this.height,0],n(s,this.range),this.isXAxis&&(this.showDomainList=l(s,this.axisConfig),t.showDomainList=u(this.showDomainList,this.axisConfig)),this.messageCenter[this.type+"Scale"]=s,this.scales=s},render:function(t,i){return this.isXAxis?this.__drawAxis(t,i):void this.on("xAxisReady.yAxis",function(){this.width=this.messageCenter.originalWidth-this.margin.left-this.margin.right,this.__drawAxis(t,i)}.bind(this))},__drawAxis:function(t,e){for(var n,r=this.type,o=this.scales,a=0;(n=this.axisConfig[a])&&n.show;a++){var s=o[a],c=i.svg.axis().scale(s).outerTickSize(0).ticks(n.ticks).orient(n.position).tickFormat(n.tickFormat);this.isXAxis||0!==a?0===a?(c.innerTickSize(-this.height),c.tickPadding(10),c.tickValues(this.showDomainList[a])):c.innerTickSize(0):c.innerTickSize(-this.width);var l=this.main.selectAll(".xc-axis."+r+"-"+a).data([n]);l.enter().append("g").attr("class","xc-axis "+r+" "+r+"-"+a).attr("fill","none").attr("stroke","#000"),"barCategory"===s.scaleType&&l.classed("xc-bar-axis",!0),l.attr("transform",h.call(this,n)).transition().ease(t).duration(e).call(c)}this.isXAxis&&this.fire("xAxisReady")},ready:function(){this._tooltipReady(),this._lengendReady()},_tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"===this.config.tooltip.trigger&&"yAxis"!=this.type){var t=this.axisConfig[0];this.on("tooltipSectionChange.axis",function(i,e){var n=t.data[i],r=t.formatter(n);e(r)})}},_lengendReady:function(){var t=this;this.on("legendClick."+t.type,function(i){var e=t.series;e.forEach(function(t){var e=t.name;t.show=!1;for(var n,r=0;n=i[r++];)if(n==e){t.show=!0;break}}),t.legendRefresh=!0,t.init(t.messageCenter,t.config,t.type,e),t.render(t.config.animation.animationEase,t.config.animation.animationTime),t.legendRefresh=!1})}});var x={value:s,time:c,category:a},m={line:function(t,e,n){var r={},o=[];i.map(t,function(t){return"line"!=t.type||t[e+"Index"]!=n||0==t.show?!1:(t.stack&&(r[t.stack]||(r[t.stack]=[]),r[t.stack].push(t.data)),void(o=o.concat(t.data)))});for(var a in r)if(r.hasOwnProperty(a)){var s=[];r[a].forEach(function(t,i){t.forEach(function(t,i){s[i]=null==s[i]?0:s[i],s[i]+=t})}),o=o.concat(s)}return 0==o.length?!1:i.extent(o,function(t){return parseFloat(t)})},bar:function(t,e,n){var r={},o=[];i.map(t,function(t){return"bar"!=t.type||t[e+"Index"]!=n||0==t.show?!1:(t.stack&&(r[t.stack]||(r[t.stack]=[]),r[t.stack].push(t.data)),void(o=o.concat(t.data)))});for(var a in r)if(r.hasOwnProperty(a)){var s=[];r[a].forEach(function(t,i){t.forEach(function(t,i){s[i]=null==s[i]?0:s[i],s[i]+=t})}),o=o.concat(s)}return 0==o.length?!1:i.extent(o,function(t){return parseFloat(t)})},scatter:function(t,e,n){var r=[];return i.map(t,function(t){"scatter"==t.type&&t[e+"Index"]==n&&0!=t.show&&i.map(t.data,function(t){r.push(t["xAxis"==e?0:1])})}),0==r.length?!1:i.extent(r,function(t){return parseFloat(t)})}}}(t,c),function(t,i){function e(t,i,e){return i.legend.show===!1?void(this._show=!1):(this._show=!0,void v.call(this,t,i,e))}function n(t,i,e){if(i){for(var n,r=!0,o=0;n=e[o++];)if(n==t){e.splice(o-1,1),r=!1;break}r&&e.push(t),0==e.length?this.fire("tooltipNone"):this.fire("tooltipShow")}else e=[t];this.fire("legendClick",e)}function r(){var t=this,e=t.legendConfig,n=t.legendSeries,r=e.itemGap,o=t.width,a=t.height,s=t.legendConfig.item.fontSize,c=t.legendConfig.item.chartSize,l=s>c?s:c,h=e.x,f=e.y,u=e.orient,d=t.margin,p=t.originalWidth,g=1.1*e.item.chartSize,m=n.map(function(t){return t.name}),v=x.calcTextWidth(m,e.item.chartSize,g).widthList,y=0,C=0,w=0,S=0,b=0;n.forEach(function(t,e){var n=v[e];t.position=[y,C],"vertical"!=u?(y+=n+r,y>o&&(w=o,y=0,C+=1.1*l)):(b=i.max([b,n]),C+=l+r,C>a&&(S=a,C=0,y+=1.1*b))});var A,k,T=30;return w=w?w:y,S=S?S:C,"vertical"!=u?(S+=l,A="right"==h?p-d.right-w:"center"==h?(o-w)/2+d.left:d.left,"top"==f?(k=d.top,d.top+=C+T):(k=a-C+d.top,d.bottom+=C+T)):(w+=b,"right"==h?(A=p-d.right-w,d.right+=w+T):(A=0,d.left+=w+T),k="center"==f?(a-S)/2+d.top:"bottom"==f?a-S+d.top:d.top),[A,k]}function o(t,i,e){var n={},r=[];t.forEach(function(t){var i=t.type;i&&(n[i]||(n[i]=[]),n[i].push(t))});for(var o in n)if(n.hasOwnProperty(o)){var s=a(o);s&&(r=r.concat(s(n[o],i,e)))}return r}function a(t){switch(t){case"radar":case"funnel":case"pie":return s;default:return c}}function s(t,i,e){var n=[];return t.forEach(function(t){var r={},o=0,a=t.type;t.data.forEach(function(t){var s,c=t.name;void 0==r[c]?(r[c]=o,s=o):s=r[c],t.idx=s,l(c,i)&&(t.color=e.getColor(s),t.type=a,n.push(t)),o++})}),n}function c(t,i,e){var n=[],r=e.getColor;return t.forEach(function(t,e){void 0===t.idx&&(t.idx=e),l(t.name,i)&&(t.lineStyle&&"auto"!==t.lineStyle.color?t.color=t.lineStyle.color:t.color=r(e),n.push(t))}),n}function l(t,i,e){for(var n,r=0;n=i[r++];){if(e&&n[e]===t)return n;if(n===t)return n}return!1}function h(t,i){var e=t/6,n=i/2,r="M0,"+n+"L"+2*e+","+n;return r+="A"+e+","+e+" 0 1 1 "+2*e+","+(n+1e-5),r+="M"+4*e+","+n+"L"+6*e+","+n}function f(t){var i=t,e="M0,"+.5*i+" A"+i/2+","+i/2+" 0 1 1 0,"+(.5*i+.001);return e}function u(t){var i=t/2,e=Math.PI/180*30,n=0,r=-i,o=Math.cos(e)*i,a=Math.sin(e)*-i,s=[],c="";return s[0]=[n,r],s[1]=[o,a],s[2]=[o,-a],s[3]=[n,-r],s[4]=[-o,-a],s[5]=[-o,a],s.forEach(function(t){t[0]+=i,t[1]+=i,c+=c?"L":"M",c+=t}),c+="z"}function d(t){var i=t/10;return"M0,"+i+" L"+t+","+i+" L"+.5*t+","+t}function p(t){var i=[0,t/4],e=[t,t/4],n=[t,t/4*3],r=[0,t/4*3];return"M"+i+" L"+e+"L"+n+"L"+r+"z"}function g(){var t={show:!1,orient:"horizontal",x:"left",y:"bottom",itemGap:10,formatter:function(t){return t},selectedMode:"multiple",data:[],item:{fontSize:14,color:"#000",chartSize:20,opacity:.3,hoverColor:"auto"}};return t}var x=t.utils,m=t.components,v=m.Component;x.inherits(e,v),m.extend({legend:e}),e.prototype.extend=t.extend,e.prototype.extend({init:function(t,i){this.legendConfig=x.merage(g(),i.legend),this.legendSeries=o(i.series,this.legendConfig.data,t),this.originalHeight=t.originalHeight,this.originalWidth=t.originalWidth,this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.groupPosition=r.call(this)},render:function(){var t=this,i=t.legendConfig.item.fontSize,e=t.legendConfig.item.chartSize,n=i>e?i:e,r=t.legendConfig.item.color,o=t.groupPosition,a=t.svg.selectAll(".xc-legend-group").data([t]);a.enter().append("g").attr("class","xc-legend-group"),a.attr("transform","translate("+o+")");var s=a.selectAll(".xc-legend-item").data(t.legendSeries);s.enter().append("g").attr("class","xc-legend-item"),s.exit().remove(),s.attr("transform",function(t){return this.isChecked=void 0==this.isChecked?!0:this.isChecked,"translate("+t.position+")"}).attr("fill",r).attr("opacity",function(){return this.isChecked?1:t.legendConfig.item.opacity}),s.html(""),s.append("text").attr("x",1.1*e).attr("y",function(){return.9*i}).attr("font-size",i).append("tspan").attr("dy",function(){return i>e?0:.5*(e-i)}).text(function(t){return t.name});var c={};s.append("path").attr("d",function(t){if(!y[t.type])throw new Error("pathD."+t.type+" not found");return c[t.type]||(c[t.type]=y[t.type](e,n)),c[t.type]}).attr("stroke",function(t){return t.color}).attr("fill",function(t){return t.color}),t.itemList=s},ready:function(){var t=this,e=t.legendConfig,r=e.item.hoverColor,o=e.item.color,a="single"!=e.selectedMode,s=e.item.opacity,c=a?this.legendSeries.map(function(t){return t.name}):[];t.itemList.on("click.legend",function(e){this.isChecked=!this.isChecked,a?i.select(this).attr("opacity",this.isChecked?1:s):(t.itemList.attr("opacity",s),i.select(this).attr("opacity",1)),n.call(t,e.name,a,c)}),t.itemList.on("mouseenter.legend",function(e){var n;n="auto"==r?e.color:r;var o=i.select(this);o.attr("fill",n),t.fire("legendMouseenter",e.name)}),t.itemList.on("mouseleave.legend",function(e){var n=i.select(this);n.attr("fill",o),t.fire("legendMouseleave",e.name)})}});var y={line:h,radar:u,pie:f,scatter:f,funnel:d,bar:p}}(t,c),function(t,i){function e(t,i,e){i.resize.enable&&a.Component.call(this,t,i,e)}function n(t){s[t.messageCenter.id]=t}function r(t){delete s[t.messageCenter.id]}var o=t.utils,a=t.components;o.inherits(e,a.Component),a.extend({resize:e});var s={};i.select(window).on("resize.refresh",function(){for(var t in s)if(s.hasOwnProperty(t))try{s[t].resize()}catch(i){"string"==typeof i?delete s[t]:console.error(i.stack)}}),e.prototype.extend=t.extend,e.prototype.extend({init:function(t,i,e,n){this.config=o.merage(c,i[e]),t.refreshAnimationEase=this.config.animationEase,t.refreshAnimationTime=this.config.animationTime},ready:function(){var t=this,i=t.config.animationTime,e=o.throttle(function(){t.messageCenter.refresh()},i+300,!0);t.resize=e,n(t),t.on("chartRemoveBind",function(){t.unBind()})},unBind:function(){r(this)},refresh:function(){},updateSeries:function(){}});var c={enable:!1,animationEase:"linear",animationTime:300}}(t,c),function(t,i){function e(t,i,e){return i.title.show===!1?void(this._show=!1):(this._show=!0,void s.call(this,t,i,e))}function n(){var t=this,i="start",e=t.titleConfig.textStyle.fontSize,n=t.titleConfig.subtextStyle.fontSize,r=t.titleConfig.x,o=t.titleConfig.y,a=t.height;return"left"===r?(r=0,i="start"):"center"===r?(r="50%",i="middle"):"right"===r&&(r="100%",i="end"),"top"==o?(o="1em",t.margin.top+=parseFloat(e)+parseFloat(n)):"center"==o?o="50%":"bottom"==o&&(o=a-parseFloat(n)-parseFloat(e)),{x:r,y:o,textAnchor:i}}function r(){var t={show:!0,text:"",subtext:"",x:"center",y:"top",textStyle:{fontSize:14,color:"#000"},subtextStyle:{fontSize:12,color:"#00"}};return t}var o=t.utils,a=t.components,s=a.Component;o.inherits(e,s),a.extend({title:e}),e.prototype.extend=t.extend,e.prototype.extend({init:function(t){this.titleConfig=o.merage(r(),this.config.title),this.height=t.originalHeight,this.titlePosition=n.call(this)},render:function(){var t=this,i=t.titleConfig.textStyle.fontSize,e=t.titleConfig.subtextStyle.fontSize,n=t.titlePosition.x,r=t.titlePosition.y,o=t.titlePosition.textAnchor,a=t.svg.selectAll(".xc-title").data([t.titleConfig]);a.enter().append("text").attr("class","xc-title");var s=a.selectAll(".xc-title-text").data([t.titleConfig]);s.enter().append("tspan").attr("class","xc-title-text"),s.text(function(t){return t.text}).attr("x",n).attr("y",r).attr("font-size",i).attr("fill",function(t){return t.textStyle.color}).attr("text-anchor",o);var c=a.selectAll(".xc-title-subtext").data([t.titleConfig]);c.enter().append("tspan").attr("class","xc-title-subtext"),c.text(function(t){return t.subtext}).attr("x",n).attr("dy","1.2em").attr("fill",function(t){return t.subtextStyle.color}).attr("font-size",e).attr("text-anchor",o)},updateSeries:function(){}})}(t,c),function(t,i){function e(t,i,e){return i.tooltip.show===!1?void(this._show=!1):(this._show=!0,void l.call(this,t,i,e))}function n(t,i){var e=this.axisX,n=this.axisY;return t<e[0]||t>e[1]||i<n[0]||i>n[1]}function r(){var t=this.main.selectAll(".xc-tooltip-line").data([this]);return t.enter().append("line").attr("class","xc-tooltip-line").attr("stroke",this.tooltipConfig.lineColor).attr("stroke-width",this.tooltipConfig.lineWidth).attr("opacity",0),t}function o(t){t.axisX=[],t.axisX[0]=t.margin.left,t.axisX[1]=t.originalWidth-t.margin.right,t.axisY=[],t.axisY[0]=t.margin.top,t.axisY[1]=t.originalHeight-t.margin.bottom}function a(){var t={show:!0,trigger:"axis",lineColor:"#008ACD",lineWidth:2};return t}var s=t.utils,c=t.components,l=c.Component;s.inherits(e,l),c.extend({tooltip:e}),e.prototype.extend=t.extend,e.prototype.extend({init:function(t,i){this.originalWidth=t.originalWidth,this.originalHeight=t.originalHeight,this.xAxisScale=t.xAxisScale,this.axisX=null,this.axisY=null,this.tooltipWidth=null,this.tooltipHeight=null,this.display=!0,this.tooltipShow=!1,(!this.config.xAxis||this.config.xAxis.length>1||"value"==this.config.xAxis[0].type)&&(this.config.tooltip.trigger="item"),this.tooltipConfig=s.merage(a(),i.tooltip)},render:function(){this.tooltip=this.div.append("div").attr("class","xc-tooltip")},ready:function(){var t=this;if("axis"===t.tooltipConfig.trigger){var e=-1,a=!0,s=-1;t.div.on("mousemove.tooltip",function(){if(t.display!==!1){a&&(a=!1,o(t),t.axisLine=r.call(t));var c=i.mouse(this),l=c[0],h=c[1],f=t.axisLine;if(n.call(t,l,h))return void t.hiddenTooltip();t.tooltipShow||t.showTooltip();var u=t.messageCenter.xAxisScale[0],d=t.config.xAxis[0].data,p=t.originalWidth-t.margin.left-t.margin.right,g=t.originalHeight-t.margin.top-t.margin.bottom,x=d.length-1,m=p/x,v=Math.round((l-t.margin.left)/m);if(v!==e){var y="";t.fire("tooltipSectionChange",v,function(i){y+=i,t.setTooltipHtml(y)},t.tooltipConfig.formatter),s=t.messageCenter.charts.bar?t.messageCenter.charts.bar.getTooltipPosition(v):u(d[v]),f.attr("x1",s).attr("x2",s).attr("y1",0).attr("y2",g),s+=t.margin.left,e=v}t.setPosition([s,h])}}),t.on("tooltipNone",function(){t.display=!1}),t.on("tooltipShow",function(){t.display=!0}),t.div.on("mouseleave.tooltip",function(){t.hiddenTooltip()})}},refresh:function(){return this._show?(this.hiddenTooltip(),this.init(this.messageCenter,this.config,this.type,this.config.series),void this.ready()):!0},updateSeries:function(){},showTooltip:function(){var t=this;t.tooltipShow=!0,t.tooltip.style({visibility:"visible"}),"axis"===this.tooltipConfig.trigger&&t.axisLine.attr("opacity",1)},hiddenTooltip:function(){var t=this;t.fire("tooltipHidden"),t.tooltipShow=!1,t.tooltip.style({visibility:"hidden"}),"axis"===this.tooltipConfig.trigger&&t.axisLine&&t.axisLine.attr("opacity",0),t.main.selectAll(".xc-tooltip-line").attr("opacity",0)},setPosition:function(t,i,e){var n=this;if(n.tooltipShow){i=i||5,e=e||5,n.tooltipWidth||(n.tooltipWidth=n.tooltip.node().clientWidth,n.tooltipWidth=parseFloat(n.tooltipWidth),n.tooltipHeight=n.tooltip.node().clientHeight,n.tooltipHeight=parseFloat(n.tooltipHeight));var r=n.tooltipWidth,o=n.tooltipHeight,a=n.originalWidth,s=n.originalHeight,c=t[0],l=t[1];c+r>a?c=c-r-i:c+=i,l+o>s?l=l-o-e:l+=e,n.tooltip.style({transform:"translate("+c+"px,"+l+"px)"})}},setTooltipHtml:function(t){this.tooltip.html(t)}})}(t,c),function(t,i){function e(t,i,e){this.width=t.width,this.height=t.height,this.id=t.id,this.getColor=t.getColor,r.call(this,t,i,e)}var n=t.utils,r=t.components.Component;n.inherits(e,r),e.prototype.extend=t.extend,e.prototype.extend({refresh:function(t,i){this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.width=this.messageCenter.width,this.height=this.messageCenter.height,this.init(this.messageCenter,this.config,this.type,this.config.series),this.render(t,i)}}),t.charts.extend({Chart:e})}(t,c),function(t,i){function e(t,i){f.call(this,t,i,"line")}function n(t,i,e){var n={},a=0,s=[];i.map(function(t){if("line"==t.type){if(t=h.merage(l(),t),t.idx=null==t.idx?a++:t.idx,!t.stack)return void s.push(t);n[t.stack]||(n[t.stack]=[]),n[t.stack].push(t)}});var c=r(t,n,e);return s=o(t,s,e),s.concat(c)}function r(t,i,e){var n=[];for(var r in i)if(i.hasOwnProperty(r)){var o=null,a="linear";i[r].forEach(function(i){if(i.show!==!1){var r=i.xAxisIndex,s=i.yAxisIndex,c=e.xAxis[r],l=(e.yAxis[s],t.xAxisScale[r]),h=t.yAxisScale[s],f=i.idx;i.interpolate=i.smooth?"monotone":"linear",i.y0Interpolate=a,i.xScale=l,i.yScale=h,a=i.interpolate,i.data=i.data.map(function(t,e){var n={};return"value"!=c.type&&(n.x=c.data[e],n.y0=o?o[e].y:h.domain()[0],n.y=parseFloat(t)+(o?o[e].y:0)),n.value=t,n.idx=f,n._serie=i,n}),o=i.data}n.push(i)})}return n}function o(t,i,e){return i=i.map(function(i){if(i.show!==!1){var n=i.xAxisIndex,r=i.yAxisIndex,o=e.xAxis[n],a=(e.yAxis[r],t.xAxisScale[n]),s=t.yAxisScale[r],c=i.idx;i.interpolate=i.smooth?"monotone":"linear",i.y0Interpolate="linear",i.xScale=a,i.yScale=s,i.data=i.data.map(function(t,e){var n={};return"value"!=o.type&&(n.x=o.data[e],n.y=parseFloat(t),n.y0=s.domain()[0]),n.value=t,n.idx=c,n._serie=i,n})}return i})}function a(t,e){var n=i.svg.line().x(function(t){return t.x}).y(function(t){return t.y}),r=i.svg.line().x(function(t){return t.x}).y(function(t){return t.y0});n.interpolate(e.interpolate);var o=n(t);r.interpolate(e.y0Interpolate);var a=r(t.reverse());return t.reverse(),s(o,a,t)}function s(t,i,e){var n=e[0],r=e[e.length-1],o=[n.x,n.y],a=[r.x,r.y0];return t+"L"+a+i+"L"+o}function c(t,i){return"<p>"+t+":&nbsp;"+i+"</p>"}function l(){var t={name:"",type:"line",xAxisIndex:0,yAxisIndex:0,smooth:!0,lineStyle:{color:"auto",width:2,radius:5},areaStyle:{show:!1,color:"auto",opacity:.3},data:[],units:""};return t}var h=t.utils,f=t.charts.Chart;t.charts.extend({line:e}),h.inherits(e,f),e.prototype.extend=t.extend,e.prototype.extend({init:function(t,i,e,r){this.xAxisScale=t.xAxisScale,this.yAxisScale=t.yAxisScale,this.series=n(this,r,i),this.timeModel="time"==i.xAxis[0].type},render:function(t,i){this.__renderArea(t,i),this.__renderLine(t,i),this.timeModel||this.__renderCircle(t,i)},__renderLine:function(t,e){var n=this.id,r=this,o="opacity "+e/2+"ms linear",a=this.main.selectAll(".xc-line-group").data([r]);a.enter().append("g").attr("class","xc-line-group"),a.exit().remove();var s=i.svg.line().x(function(t){return t.x}).y(function(t){return t.y}),c=a.selectAll(".xc-line-path").data(r.series);c.enter().append("path").attr("class","xc-line-path").attr("fill","none"),c.exit().remove(),c.attr("stroke",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:r.getColor(t.idx)}).attr("stroke-width",function(t){return t.lineStyle.width}).attr("id",function(t){return"xc-line-path-id"+n+"-"+t.idx}).style("transition",o).style("opacity",function(t){return t.show===!1?0:1}),c.transition().duration(e).ease(t).attrTween("d",function(t){var e=this;if(t.show===!1)return function(){return e.linePath};var n=t.data.map(function(i){return{x:t.xScale(i.x),y:t.yScale(i.y)}});this.lineData=void 0==this.lineData?n:this.lineData;var r=i.interpolate(this.lineData,n);return this.lineData=n,function(i){var n=r(i);s.interpolate(t.interpolate);var o=s(n);return 1==i&&(e.linePath=o),o}})},__renderArea:function(t,e){var n=this.id,r=this,o="opacity "+e/2+"ms linear",s=r.main.selectAll(".xc-area-group").data([r]);s.enter().append("g").attr("class","xc-area-group"),s.exit().remove();var c=s.selectAll(".xc-line-area-path").data(r.series);c.enter().append("path").attr("class","xc-line-area-path").attr("stroke","none"),c.exit().remove(),c.attr("fill",function(t){return"auto"==t.areaStyle.color?"auto"==t.lineStyle.color?r.getColor(t.idx):t.lineStyle.color:t.areaStyle.color}).attr("id",function(t){return"xc-line-area-path-id"+n+"-"+t.idx}).style("transition",o).style("opacity",function(t){return t.show===!1?0:t.areaStyle.opacity}),c.transition().duration(e).ease(t).attrTween("d",function(t){var e=this;if(t.show===!1)return function(){return null==e.areaPath?"":e.areaPath};if(t.areaStyle.show===!1)return function(){return""};var n=t.data.map(function(i){return{x:t.xScale(i.x),y:t.yScale(i.y),y0:t.yScale(i.y0)}});e.areaData=void 0==e.areaData?n:e.areaData;var r=i.interpolate(this.areaData,n);return e.areaData=n,function(i){var n=r(i),o=a(n,t);return 1==i&&(e.areaPath=o),o}})},__renderCircle:function(t,e){var n=this.id,r=this,o=r.messageCenter.showDomainList[0],a="opacity "+e/2+"ms linear",s=r.main.selectAll(".xc-circle-group").data(r.series);s.enter().append("g").attr("class",function(t){return"xc-circle-group"}),s.exit().remove(),s.attr("id",function(t){return"xc-circle-group-id"+n+"-"+t.idx}).attr("fill",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:r.getColor(t.idx)});var c=s.selectAll("circle").data(function(t){return t.data});c.enter().append("circle").attr("class",function(t,i){return"xc-point xc-point-"+i;
}),c.exit().remove(),c.style("transition",a).style("opacity",function(t){return"object"!=typeof t?0:1}).style("display",function(t,i){return o[i]!==!0?"none":"block"}).attr("r",function(t){return"object"==typeof t&&(this.circleRadius=t._serie.lineStyle.radius),this.circleRadius}),c.transition().duration(e).ease(t).attrTween("cx",function(t){var e=this;if("object"!=typeof t)return function(){return e.circleCX};var n=t._serie.xScale(t.x);e.circleCX=void 0==e.circleCX?n:e.circleCX;var r=i.interpolate(e.circleCX,n);return e.circleCX=n,function(t){return r(t)}}).attrTween("cy",function(t){var e=this;if("object"!=typeof t)return function(){return e.circleCY};var n=t._serie.yScale(t.y);e.circleCY=void 0==e.circleCY?n:e.circleCY;var r=i.interpolate(e.circleCY,n);return e.circleCY=n,function(t){return r(t)}}),r.circleGroup=c},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){function t(t){for(var i,e=o.series,n=0;i=e[n++];)if(i.name==t)return i}var e,n,r,o=this,a=o.id;this.on("legendMouseenter.line",function(s){e=o.main.selectAll(".xc-line-use").data([o]),n=o.main.selectAll(".xc-line-area-use").data([o]),r=o.main.selectAll(".xc-circle-use").data([o]),e.enter().append("use").attr("class","xc-line-use"),n.enter().append("use").attr("class","xc-line-area-use"),r.enter().append("use").attr("class","xc-circle-use");var c=t(s);if(c){var l="#xc-line-path-id"+a+"-"+c.idx,h="#xc-line-area-path-id"+a+"-"+c.idx,f="#xc-circle-group-id"+a+"-"+c.idx;e.attr("xlink:href",l),n.attr("xlink:href",h),r.attr("xlink:href",f),i.select(l).attr("stroke-width",c.lineStyle.width+1)}}),this.on("legendMouseleave.line",function(o){var s=t(o);if(s){var c="#xc-line-path-id"+a+"-"+s.idx,l=("#xc-line-area-path-id"+a+"-"+s.idx,"#xc-circle-group-id"+a+"-"+s.idx);e.attr("xlink:href",""),n.attr("xlink:href",""),r.attr("xlink:href",""),i.select(c).attr("stroke",s.color).attr("stroke-width",s.lineStyle.width),i.select(l).attr("fill",s.color)}}),this.on("legendClick.line",function(t){var i=o.config.series,e=o.config.animation;o.init(o.messageCenter,o.config,o.type,i),o.render(e.animationEase,e.animationTime)})},__tooltipReady:function(){var t=this;if(this.config.tooltip&&this.config.tooltip.show!==!1)if("axis"==this.config.tooltip.trigger)this.on("tooltipSectionChange.line",function(i,e,n){var r="",o=t.series;t.timeModel&&(t.main.selectAll(".xc-tooltip-circle").remove(),t.series.forEach(function(e){var n=e.data[i];t.main.append("circle").datum(n).attr("class","xc-tooltip-circle").attr("r",function(t){return t._serie.lineStyle.radius}).attr("cx",function(t){return t._serie.xScale(t.x)}).attr("cy",function(t){return t.yScale(t.y)}).attr("fill",function(t){return t._serie.color})})),o.forEach(function(t){if(t.show!==!1){var e=void 0===t.data[i]?"":t.data[i].value,o=t.formatter||n||c;r+=o(t.name,e)}}),e(r)}),this.on("tooltipHidden",function(){t.main.selectAll(".xc-tooltip-circle").remove()});else{var e=t.messageCenter.components.tooltip,n=e.tooltipConfig.formatter,r=t.messageCenter.components.xAxis.axisConfig;t.circleGroup.on("mouseenter",function(t){var o=i.event.srcElement||i.event.target;o=i.select(o);var t=o.data()[0],a=t.value,s=t._serie.name,l=t._serie.formatter||n||c,h=l(s,a),f=t.x;f=r[t._serie.xAxisIndex].tickFormat(f);var u="<p>"+f+"</p>";e.show(),e.setTooltipHtml(u+h);var d=i.event,p=d.layerX||d.offsetX,g=d.layerY||d.offsetY;e.setPosition([p,g])}),t.circleGroup.on("mouseleave",function(){e.hidden()})}}})}(t,c),t});